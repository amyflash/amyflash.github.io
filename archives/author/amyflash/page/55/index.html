<!DOCTYPE html>
<html class="no-js" lang="zh-Hans">

	<head><meta charset="UTF-8">

		
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="profile" href="https://gmpg.org/xfn/11">

		<title>amyflash – 第 55 页 – 逍遥居</title>
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="逍遥居 » Feed" href="/feed">
<link rel="alternate" type="application/rss+xml" title="逍遥居 » 评论 Feed" href="/comments/feed">
<link rel="alternate" type="application/rss+xml" title="逍遥居 » 由 amyflash 发表的文章 Feed" href="/archives/author/amyflash/feed">
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.3"}};
/*! This file is auto-generated */
!function(s,n){var o,i,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),a=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===a[t]})}function u(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);for(var n=e.getImageData(16,16,1,1),a=0;a<n.data.length;a++)if(0!==n.data[a])return!1;return!0}function f(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\udedf")}return!1}function g(e,t,n,a){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):s.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0}),i=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(function(e){i[e]=t(o,e,n,a)}),i}function t(e){var t=s.createElement("script");t.src=e,t.defer=!0,s.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",i=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){s.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+g.toString()+"("+[JSON.stringify(i),f.toString(),p.toString(),u.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"}),r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=function(e){c(n=e.data),r.terminate(),t(n)})}catch(e){}c(n=g(i,f,p,u))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.8.3" media="all">
<style id="classic-theme-styles-inline-css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--accent: #cd2653;--wp--preset--color--primary: #000000;--wp--preset--color--secondary: #6d6d6d;--wp--preset--color--subtle-background: #dcd7ca;--wp--preset--color--background: #f5efe0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 18px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 26.25px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 21px;--wp--preset--font-size--larger: 32px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="twentytwenty-style-css" href="/wp-content/themes/twentytwenty/style.css?ver=2.9" media="all">
<style id="twentytwenty-style-inline-css">
.color-accent,.color-accent-hover:hover,.color-accent-hover:focus,:root .has-accent-color,.has-drop-cap:not(:focus):first-letter,.wp-block-button.is-style-outline,a { color: #cd2653; }blockquote,.border-color-accent,.border-color-accent-hover:hover,.border-color-accent-hover:focus { border-color: #cd2653; }button,.button,.faux-button,.wp-block-button__link,.wp-block-file .wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.bg-accent,.bg-accent-hover:hover,.bg-accent-hover:focus,:root .has-accent-background-color,.comment-reply-link { background-color: #cd2653; }.fill-children-accent,.fill-children-accent * { fill: #cd2653; }body,.entry-title a,:root .has-primary-color { color: #000000; }:root .has-primary-background-color { background-color: #000000; }cite,figcaption,.wp-caption-text,.post-meta,.entry-content .wp-block-archives li,.entry-content .wp-block-categories li,.entry-content .wp-block-latest-posts li,.wp-block-latest-comments__comment-date,.wp-block-latest-posts__post-date,.wp-block-embed figcaption,.wp-block-image figcaption,.wp-block-pullquote cite,.comment-metadata,.comment-respond .comment-notes,.comment-respond .logged-in-as,.pagination .dots,.entry-content hr:not(.has-background),hr.styled-separator,:root .has-secondary-color { color: #6d6d6d; }:root .has-secondary-background-color { background-color: #6d6d6d; }pre,fieldset,input,textarea,table,table *,hr { border-color: #dcd7ca; }caption,code,code,kbd,samp,.wp-block-table.is-style-stripes tbody tr:nth-child(odd),:root .has-subtle-background-background-color { background-color: #dcd7ca; }.wp-block-table.is-style-stripes { border-bottom-color: #dcd7ca; }.wp-block-latest-posts.is-grid li { border-top-color: #dcd7ca; }:root .has-subtle-background-color { color: #dcd7ca; }body:not(.overlay-header) .primary-menu > li > a,body:not(.overlay-header) .primary-menu > li > .icon,.modal-menu a,.footer-menu a, .footer-widgets a:where(:not(.wp-block-button__link)),#site-footer .wp-block-button.is-style-outline,.wp-block-pullquote:before,.singular:not(.overlay-header) .entry-header a,.archive-header a,.header-footer-group .color-accent,.header-footer-group .color-accent-hover:hover { color: #cd2653; }.social-icons a,#site-footer button:not(.toggle),#site-footer .button,#site-footer .faux-button,#site-footer .wp-block-button__link,#site-footer .wp-block-file__button,#site-footer input[type="button"],#site-footer input[type="reset"],#site-footer input[type="submit"] { background-color: #cd2653; }.header-footer-group,body:not(.overlay-header) #site-header .toggle,.menu-modal .toggle { color: #000000; }body:not(.overlay-header) .primary-menu ul { background-color: #000000; }body:not(.overlay-header) .primary-menu > li > ul:after { border-bottom-color: #000000; }body:not(.overlay-header) .primary-menu ul ul:after { border-left-color: #000000; }.site-description,body:not(.overlay-header) .toggle-inner .toggle-text,.widget .post-date,.widget .rss-date,.widget_archive li,.widget_categories li,.widget cite,.widget_pages li,.widget_meta li,.widget_nav_menu li,.powered-by-wordpress,.footer-credits .privacy-policy,.to-the-top,.singular .entry-header .post-meta,.singular:not(.overlay-header) .entry-header .post-meta a { color: #6d6d6d; }.header-footer-group pre,.header-footer-group fieldset,.header-footer-group input,.header-footer-group textarea,.header-footer-group table,.header-footer-group table *,.footer-nav-widgets-wrapper,#site-footer,.menu-modal nav *,.footer-widgets-outer-wrapper,.footer-top { border-color: #dcd7ca; }.header-footer-group table caption,body:not(.overlay-header) .header-inner .toggle-wrapper::before { background-color: #dcd7ca; }
</style>
<link rel="stylesheet" id="twentytwenty-fonts-css" href="/wp-content/themes/twentytwenty/assets/css/font-inter.css?ver=2.9" media="all">
<link rel="stylesheet" id="twentytwenty-print-style-css" href="/wp-content/themes/twentytwenty/print.css?ver=2.9" media="print">
<script src="/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script src="/wp-content/plugins/html5-audio-player/js/inline-player.js?ver=2.1.12" id="add-inline-player-js"></script>
<script src="/wp-content/themes/twentytwenty/assets/js/index.js?ver=2.9" id="twentytwenty-js-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/users/1"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.8.3">
            <style>
                .h5ap_inline_player {
                    display: inline-block;
                    line-height: 1.45;
                }
                .h5ap_inline_player span {
                    display: inline-block;
                    line-height: 1.20;
                    font-size: 130%;
                    width: auto;
                    height: auto;
                    cursor: pointer;
                }
                .h5ap_inline_player span.dashicons-controls-pause {
                    display: none;
                }
                </style>
        	<script>document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );</script>
	
	</head>

	<body class="archive paged author author-amyflash author-1 wp-embed-responsive paged-55 author-paged-55 wp-theme-twentytwenty enable-search-modal has-no-pagination showing-comments show-avatars footer-top-visible">

		<a class="skip-link screen-reader-text" href="#site-content">跳至内容</a>
		<header id="site-header" class="header-footer-group">

			<div class="header-inner section-inner">

				<div class="header-titles-wrapper">

					
						<button class="toggle search-toggle mobile-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
							<span class="toggle-inner">
								<span class="toggle-icon">
									<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewbox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)"></path></svg>								</span>
								<span class="toggle-text">搜索</span>
							</span>
						</button><!-- .search-toggle -->

					
					<div class="header-titles">

						<div class="site-title faux-heading"><a href="/" rel="home">逍遥居</a></div><div class="site-description">琴棋书画诗酒花</div><!-- .site-description -->
					</div><!-- .header-titles -->

					<button class="toggle nav-toggle mobile-nav-toggle" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" aria-expanded="false" data-set-focus=".close-nav-toggle">
						<span class="toggle-inner">
							<span class="toggle-icon">
								<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="26" height="7" viewbox="0 0 26 7"><path fill-rule="evenodd" d="M332.5,45 C330.567003,45 329,43.4329966 329,41.5 C329,39.5670034 330.567003,38 332.5,38 C334.432997,38 336,39.5670034 336,41.5 C336,43.4329966 334.432997,45 332.5,45 Z M342,45 C340.067003,45 338.5,43.4329966 338.5,41.5 C338.5,39.5670034 340.067003,38 342,38 C343.932997,38 345.5,39.5670034 345.5,41.5 C345.5,43.4329966 343.932997,45 342,45 Z M351.5,45 C349.567003,45 348,43.4329966 348,41.5 C348,39.5670034 349.567003,38 351.5,38 C353.432997,38 355,39.5670034 355,41.5 C355,43.4329966 353.432997,45 351.5,45 Z" transform="translate(-329 -38)"></path></svg>							</span>
							<span class="toggle-text">菜单</span>
						</span>
					</button><!-- .nav-toggle -->

				</div><!-- .header-titles-wrapper -->

				<div class="header-navigation-wrapper">

					
							<nav class="primary-menu-wrapper" aria-label="水平">

								<ul class="primary-menu reset-list-style">

								<li id="menu-item-5428" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5428"><a href="/">首页</a></li>
<li id="menu-item-6352" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6352"><a href="/td/">待办</a></li>
<li id="menu-item-6353" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6353"><a href="/blog/">知识库</a></li>
<li id="menu-item-6354" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6354"><a href="https://box.1006868.xyz:6443/">私有云盘</a></li>
<li id="menu-item-6356" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6356"><a href="https://bk.1006868.xyz/chat/">私人助理</a></li>
<li id="menu-item-6359" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6359"><a href="/%e5%a4%9a%e5%a4%9a%e8%af%b4%e4%b8%93%e9%a2%98">多多说专题</a></li>
<li id="menu-item-5438" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5438"><a href="/sample-page">留言版</a></li>
<li id="menu-item-6374" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6374"><a href="https://book.1006868.xyz/">私人图书馆</a></li>
<li id="menu-item-6375" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6375"><a href="https://music.1006868.xyz/">私人影音室</a></li>
<li id="menu-item-6376" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6376"><a href="https://chatroom.1006868.xyz/">私人聊天室</a></li>

								</ul>

							</nav><!-- .primary-menu-wrapper -->

						
						<div class="header-toggles hide-no-js">

						
							<div class="toggle-wrapper search-toggle-wrapper">

								<button class="toggle search-toggle desktop-search-toggle" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field" aria-expanded="false">
									<span class="toggle-inner">
										<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewbox="0 0 23 23"><path d="M38.710696,48.0601792 L43,52.3494831 L41.3494831,54 L37.0601792,49.710696 C35.2632422,51.1481185 32.9839107,52.0076499 30.5038249,52.0076499 C24.7027226,52.0076499 20,47.3049272 20,41.5038249 C20,35.7027226 24.7027226,31 30.5038249,31 C36.3049272,31 41.0076499,35.7027226 41.0076499,41.5038249 C41.0076499,43.9839107 40.1481185,46.2632422 38.710696,48.0601792 Z M36.3875844,47.1716785 C37.8030221,45.7026647 38.6734666,43.7048964 38.6734666,41.5038249 C38.6734666,36.9918565 35.0157934,33.3341833 30.5038249,33.3341833 C25.9918565,33.3341833 22.3341833,36.9918565 22.3341833,41.5038249 C22.3341833,46.0157934 25.9918565,49.6734666 30.5038249,49.6734666 C32.7048964,49.6734666 34.7026647,48.8030221 36.1716785,47.3875844 C36.2023931,47.347638 36.2360451,47.3092237 36.2726343,47.2726343 C36.3092237,47.2360451 36.347638,47.2023931 36.3875844,47.1716785 Z" transform="translate(-20 -31)"></path></svg>										<span class="toggle-text">搜索</span>
									</span>
								</button><!-- .search-toggle -->

							</div>

							
						</div><!-- .header-toggles -->
						
				</div><!-- .header-navigation-wrapper -->

			</div><!-- .header-inner -->

			<div class="search-modal cover-modal header-footer-group" data-modal-target-string=".search-modal" role="dialog" aria-modal="true" aria-label="搜索">

	<div class="search-modal-inner modal-inner">

		<div class="section-inner">

			<form role="search" aria-label="搜索：" method="get" class="search-form" action="/">
	<label for="search-form-1">
		<span class="screen-reader-text">
			搜索：		</span>
		<input type="search" id="search-form-1" class="search-field" placeholder="搜索…" value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="搜索">
</form>

			<button class="toggle search-untoggle close-search-toggle fill-children-current-color" data-toggle-target=".search-modal" data-toggle-body-class="showing-search-modal" data-set-focus=".search-modal .search-field">
				<span class="screen-reader-text">
					关闭搜索				</span>
				<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102"></polygon></svg>			</button><!-- .search-toggle -->

		</div><!-- .section-inner -->

	</div><!-- .search-modal-inner -->

</div><!-- .menu-modal -->

		</header><!-- #site-header -->

		
<div class="menu-modal cover-modal header-footer-group" data-modal-target-string=".menu-modal">

	<div class="menu-modal-inner modal-inner">

		<div class="menu-wrapper section-inner">

			<div class="menu-top">

				<button class="toggle close-nav-toggle fill-children-current-color" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" data-set-focus=".menu-modal">
					<span class="toggle-text">关闭菜单</span>
					<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102"></polygon></svg>				</button><!-- .nav-toggle -->

				
					<nav class="mobile-menu" aria-label="移动设备">

						<ul class="modal-menu reset-list-style">

						<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5428"><div class="ancestor-wrapper"><a href="/">首页</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6352"><div class="ancestor-wrapper"><a href="/td/">待办</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6353"><div class="ancestor-wrapper"><a href="/blog/">知识库</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6354"><div class="ancestor-wrapper"><a href="https://box.1006868.xyz:6443/">私有云盘</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6356"><div class="ancestor-wrapper"><a href="https://bk.1006868.xyz/chat/">私人助理</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6359"><div class="ancestor-wrapper"><a href="/%e5%a4%9a%e5%a4%9a%e8%af%b4%e4%b8%93%e9%a2%98">多多说专题</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5438"><div class="ancestor-wrapper"><a href="/sample-page">留言版</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6374"><div class="ancestor-wrapper"><a href="https://book.1006868.xyz/">私人图书馆</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6375"><div class="ancestor-wrapper"><a href="https://music.1006868.xyz/">私人影音室</a></div><!-- .ancestor-wrapper --></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6376"><div class="ancestor-wrapper"><a href="https://chatroom.1006868.xyz/">私人聊天室</a></div><!-- .ancestor-wrapper --></li>

						</ul>

					</nav>

					
			</div><!-- .menu-top -->

			<div class="menu-bottom">

				
			</div><!-- .menu-bottom -->

		</div><!-- .menu-wrapper -->

	</div><!-- .menu-modal-inner -->

</div><!-- .menu-modal -->

<main id="site-content">

	
		<header class="archive-header has-text-align-center header-footer-group">

			<div class="archive-header-inner section-inner medium">

									<h1 class="archive-title">作者： <span>amyflash</span></h1>
				
				
			</div><!-- .archive-header-inner -->

		</header><!-- .archive-header -->

		
<article class="post-1884 post type-post status-publish format-standard hentry category-115" id="post-1884">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1884">Apache日志的配置</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1884">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>1、日志类型<br>
　　<br>
      1.3 版本Apache 的标准中规定了4类日志：<br>
　　<br>
      错误日志<br>
　　<br>
      访问日志<br>
　　<br>
      传输日志<br>
　　<br>
      Cookie日志<br>
　　<br>
      其中：传输日志和Cookie日志被Apache 2.0认为已经过时。所以本文仅讨论错误日志和访问日志。同时错误日志和访问日志被Apache 2.0默认设置。<br>
　　<br>
      错误日志包含：<br>
　　<br>
      获知失效链接<br>
　　<br>
      获知 CGI 错误<br>
　　<br>
      获知用户认证错误<br>
　　<br>
      访问日志包含：<br>
　　<br>
      访问服务器的远程机器的地址：可以得知浏览者来自何方<br>
　　<br>
      浏览者访问的资源：可以得知网站中的哪些部分最受欢迎<br>
　　<br>
      浏览者的浏览时间：可以从浏览时间(如工作时间或休闲时间)对网站内容进行调整<br>
　　<br>
      浏览者使用的浏览器：可以根据大多数浏览者使用的浏览器对站点进行优化<br>
　　<br>
      访问日志分类：<br>
　　<br>
      为了便于分析 Apache 的访问日志，Apache 的默认配置文件中，按记录的信息不同(用不同格式昵称说明不同的信息)将访问日志分为4类：<br>
　　<br>
      代理日志格式(agent log format) agent 记录请求的用户代理<br>
　　<br>
      综合日志格式(combined log format) combined 结合以上三种日志信息<br>
　　<br>
      普通日志格式(common log format,CLF) common 大多数日志分析软件都支持这种格式<br>
　　<br>
      参考日志格式(referer log format) referer 记录客户访问站点的用户身份<br>
　　<br>
      2、配置访问日志命令<br>
　　<br>
      CustomLog 命令用来对服务器的请求进行日志记录。格式为：<br>
　　<br>
      格式1：CustomLog 访问日志文件名 记录格式说明串|格式昵称<br>
　　<br>
      格式2：CustomLog “|管道程序名 访问日志文件名” 记录格式说明串|格式昵称<br>
　　<br>
      说明：<br>
　　<br>
      访问日志文件名：除非文件位置用”/“开头，否则所制定的文件位置是相对于 ServerRoot 目录的相对路径<br>
　　<br>
      格式昵称：使用 LogFormat 命令将一个记录格式说明串赋以一个名称<br>
　　<br>
      记录格式说明串：用字符串和格式说明符(以%开头)指定日志记录的内容<br>
　　<br>
      管道程序名：管道符”|”后面紧跟着一个程序的路径，这个程序把日志从标准输入设备中读入并处理。<br>
　　<br>
      LogFormat 命令用于定义访问日志的记录格式。格式为：<br>
　　<br>
      LogFormat “记录格式说明串” 格式昵称<br>
　　<br>
      从apache2.conf 中可知，在Apache 中定义了下面的 4 种类型的访问日志：<br>
       LogFormat “%h %l %u %t \”%r\” %&gt;s %b \”%{Referer}i\” \”%{User-Agent}i\”” combined<br>
　　LogFormat “%h %l %u %t \”%r\” %&gt;s %b” common<br>
　　LogFormat “%{Referer}i -&gt; %U” referer<br>
　　LogFormat “%{User-agent}i” agent<br>
       由于综合日志格式简单地结合了3种日志信息，所以在配置访问日志时，要么使用一个综合文件进行记录，要么使用分离的多个(1-3)文件记录。通常使用一个综合日志格式文件进行记录，配置为：<br>
CustomLog /var/log/apache2/access.log combined<br>
　　若使用3个文件分别进行记录，配置为：<br>
      CustomLog /var/log/apache2/access.log common<br>
　　CustomLog /var/log/apache2/referer.log referer<br>
　　CustomLog /var/log/apache2/agent.log agent<br>
　　下面的命令组：<br>
      LogFormat “%h %l %u %t \”%r\” %&gt;s %b” common<br>
　　CustomLog logs/access_log common<br>
　　与下面的命令等效：<br>
CustomLog logs/access_log “%h %l %u %t \”%r\” %&gt;s %b”<br>
　　通常我们配置访问日志时，使用先使用 LogFormat 命令定义格式昵称，然后再在 CustomLog 命令中引用昵称的方法。<br>
　　在使用 LogFormat 和 CustomLog 命令中为了说明要记录的日志内容，可以使用的常用格式说明符如表-3。<br>
格式说明符<br>
说明<br>
%v<br>
进行服务的服务器的标准名字 ServerName，通常用于虚拟主机的日志记录中。<br>
%h<br>
客户机的 IP 地址。<br>
%l<br>
从identd服务器中获取远程登录名称，基本已废弃。<br>
%u<br>
来自于认证的远程用户。<br>
%t<br>
连接的日期和时间。<br>
%r<br>
HTTP请求的首行信息，典型格式是“METHOD RESOURCE PROTOCOL”，即“方法 资源 协议”。经常可能出现的 METHOD 是 GET、POST 和 HEAD；RESOURCE 是指浏览者向服务器请求的文档或 URL；PROTOCOL 通常是HTTP，后面再加上版本号，通常是 HTTP/1.1。<br>
%&gt;s<br>
响应请求的状态代码，一般这项的值是 200，表示服务器已经成功地响应浏览器的请求，一切正常；以 3 开头的状态代码表示由于各种不同的原因用户请求被重定向到了其他位置；以 4 开头的状态代码表示客户端存在某种错误；以 5 开头的状态代码表示服务器遇到了某个错误。<br>
%b<br>
传送的字节数（不包含HTTP头信息），将日志记录中的这些值加起来就可以得知服务器在一天、一周或者一月内发送了多少数据。<br>
%{Referer}i<br>
记录引用此资源的网页。<br>
%U<br>
请求的URL路径，不包含查询串。<br>
　　图2是从一个访问日志文件中截取的几条记录。这里使用winscp远程登录到Solaris 10 服务器的日志文件目录。</p>
<p>apache 访问日志</p>
<p>　图2 apache 访问日志<br>
　　<br>
       将其中一列各项信息分离于表-4所示。</p>
<p>格式说明符</p>
<p>举例1<br>
%h<br>
远程主机IP<br>
192.168.220.1<br>
%l</p>
<p>-（表示没有取得信息）<br>
%u</p>
<p>–<br>
%t<br>
访问日期，时间和时差</p>
<p>14/Oct/2008:19:54:51 +0800<br>
%r<br>
请求 / 版本<br>
“GET / HTTP/1.1”<br>
%&gt;s<br>
服务状态码<br>
404<br>
%b<br>
发送的字节数<br>
1185<br>
%{Referer}i</p>
<p>”-”<br>
%{User-Agent}i</p>
<p>　　3、配置错误日志</p>
<p>　　错误日志记录了服务器运行期间遇到的各种错误，以及一些普通的诊断信息，比如服务器何时启动、何时关闭等。</p>
<p>　　ErrorLog 命令指定了当服务器遇到错误时记录错误日志的文件名。其格式为：</p>
<p>　　格式1：ErrorLog 错误日志文件名</p>
<p>　　格式2：ErrorLog “|管道程序名”</p>
<p>　　格式1直接指定错误日志文件名，除非文件位置用”/“开头，否则 ErrorLog 所制定的文件位置是相对于 ServerRoot 目录的相对路径。</p>
<p>　　格式2实现管道日志，它指定一个命令来处理错误日志。</p>
<p>　　Apache 编译时默认的错误日志可以使用如下命令获得：<br>
      $ apache2 -V| grep DEFAULT_ERRORLOG<br>
　　-D DEFAULT_ERRORLOG=”logs/error_log”<br>
　　LogLevel</p>
<p>　　LogLevel 用于调整记于错误日志中的信息的详细程度。<br>
等级<br>
应用说明<br>
级别<br>
emerg<br>
出现紧急情况使得该系统不可用，如系统宕机等<br>
1<br>
alert<br>
需要立即引起注意的情况<br>
2<br>
crit<br>
危险情况的警告<br>
3<br>
error<br>
除了emerg、alert、crit的其他错误<br>
4<br>
warn<br>
警告信息<br>
5<br>
notice<br>
需要引起注意的情况，但不如error、warn重要<br>
6<br>
info<br>
值得报告的一般消息<br>
7<br>
debug<br>
由运行于debug模式的程序所产生的消息<br>
8<br>
　　图3是从一个访问错误文件中截取的几条记录。这里使用winscp远程登录到Solaris 10 服务器的日志文件目录。</p>
<p>apache 错误日志</p>
<p>　　图3 apache 错误日志</p>
<p>　　从文件内容可以看出，每一行记录了一个错误。格式为：</p>
<p>　　日期和时间 错误等级 错误消息</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1882 post type-post status-publish format-standard hentry category-115" id="post-1882">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1882">referer</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1882">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>由于项目需要,我接触到了javascript中的referer. 在网上找资料的时候,发现有这两篇文章对referer写得蛮好的,现把它们转贴到下面,一起学习.</p>
<p>第1篇–(http://huxiong888.blog.163.com/blog/static/1344952201061501535775/)</p>
<p>Referrer的重要性</p>
<p>HTTP请求中有一个referer的报文头，用来指明当前流量的来源参考页。例如在www.sina.com.cn/sports/上点击一个链接到达cctv.com首页，那么就referrer就是www.sina.com.cn/sports/了。在Javascript中，我们可以通过 document.referrer来获取同样的信息。通过这个信息，我们就可以知道访客是从什么渠道来到当前页面的。这对于Web Analytics来说，是非常重要的，这可以告诉我们不同渠道带来的流量的分布情况，还有用户搜索的关键词等，都是通过分析这个referrer信息来获取的。</p>
<p>但是，出于各种各样的原因，有时候Javascript中读到的referrer却是空字符串。下面总结一下哪些情况下会丢失referrer。</p>
<p>Referrer丢失的几个场景<br>
修改Location对象进行页面导航<br>
Location对象是一个用于页面导航的非常实用的对象。因为他允许你只变更Url的其中一部分。例如从cn域名切换到com域名，其他部分不变：</p>
<p>window.location.hostname = “example.com”;<br>
但是，通过修改Location进行页面导航的方法，会导致在IE下丢失Referrer。</p>
<p>IE5.5+ 下返回空字符串</p>
<p>Chrome3.0+，Firefox3.5，Opera9.6，Safari3.2.2均正常返回来源网页</p>
<p>window.open方式打开新窗口<br>
示例：</p>
<p><a href="#" onclick="window.open('http://www.google.com')">访问Google</a><br>
点击此链接会在新窗口打开Google网站，我们在地址栏中输入以下js代码就可以看到发送的referrer了。</p>
<p>javascript:alert(document.referrer)<br>
测试结果：</p>
<p>IE5.5+ 下返回空字符串</p>
<p>Chrome3.0+，Firefox3.5，Opera9.6，Safari3.2.2均正常返回来源网页</p>
<p>如果是同个域名下通过此方式跳转的，那么我们可以通过访问windoww.opener对象去获取丢失的referrer信息。代码如下：</p>
<p><script type="text/javascript">
    var referrer = document.referrer;
    if (!referrer) {
        try {
            if (window.opener) {
                // IE下如果跨域则抛出权限异常
                // Safari和Chrome下window.opener.location没有任何属性
                referrer = window.opener.location.href;
            }
        }
        catch (e) {}
    }
</script><br>
跨域的话则没辙了~</p>
<p>鼠标拖拽打开新窗口<br>
鼠标拖拽是现在非常流行的用户习惯，很多浏览器都内置或者可以通过插件的方式来支持鼠标拖拽式浏览。但是通过这种方式打开的页面，基本全都丢失 referrer。并且，这种情况下，也无法使用window.opener的方式去获取丢失的referrer了。</p>
<p>已测试：</p>
<p>Maxthon2.5.2，Firefox的FireGesture插件，Chrome3.0+，Opera9.6，Safari3.2。</p>
<p>点击Flash内部链接<br>
点击Flash上到达另外一个网站的时候，Referrer的情况就比较杂乱了。</p>
<p>IE下，通过客户端Javascript的document.referrer读取到的值是空的，但是如果你使用流量监控软件看一下的话，你会发现，实际上HTTP请求中的Referer报文头却是有值的，这可能是IE实现的Bug。同时，这个值指向的是Flash文件的地址，而不是来源网页的地址。</p>
<p>Chrome4.0下点击Flash到达新窗口之后，Referrer也是指向的Flash文件的地址，而不是源网页的地址。</p>
<p>Chrome3.0和Safari3.2是一样的，都是会丢失Referrer信息。</p>
<p>Opera则和Firefox一样，Referrer的值都是来源网页的地址。</p>
<p>HTTPS跳转到HTTP<br>
从HTTPS的网站跳转到HTTP的网站时，浏览器是不会发送referrer的。这个各大浏览器的行为是一样的。</p>
<p>例如，我们在HTTPS下使用Google Reader或是Gmail的时候，点击某个链接去到另外一个网站，那么从技术上来说，这样的访问和用户直接键入网址访问是没有什么分别的。</p>
<p>Referrer丢失对于广告流量监控的影响<br>
Referrer如果丢失，Web Analytics就会丢掉很重要的一部分信息了，特别对于广告流量来说，就无法知道实际来源了。目前国内好多用了Google Adsense广告的网站，都使用了window.open的方式来打开广告链接，因此IE下会丢失Referrer，而我们知道，IE是目前市场份额最大的浏览器，因此其影响是很大的。很多流量统计工具会因此将这部分流量归入“直接流量”，和用户直接键入网址等价了。</p>
<p>对于这样的情况，需要让广告投放者在投放广告的时候，给着陆页面的Url加上特定的跟踪参数。</p>
<p>例如，某个Flash广告，点击之后到达的网址是http://www.example.com/，为了监控此流量是从哪个渠道过来的，我们可以修改此投放的着陆Url，改成http://www.example.com/?src=sina，类似这种方式，然后在着陆页面中使用 Javascript代码提取此src参数，这样就可以得到广告来源信息。</p>
<p>在投放Google Adwords的时候，后台系统有一个“自动标记”的选项，当启用此选项的时候，Google在生成所有广告的着陆页面Url的时候，就会自动加上一个 gclid的参数，这个参数能够将Google Analytics后台和Adwords广告后台的数据进行整合。这样就可以知道广告流量对应于哪个广告系列，哪个广告来源和广告关键词等信息了。和上面提到的思路其实是类似的。只不过Google自动帮你做了Url的修改了而已。</p>
<p>第二篇–(http://blog.163.com/alex_kame/blog/static/14546748201072173718721/)</p>
<p>兼容IE和FF：获取Referer的JS方法</p>
<p>发现一个关于浏览器兼容的问题，当用JS 执行代码 window.location.href=”http://ityizhan.com” 来进行跳转的时候，Firefox 可以获取到到HTTP_REFERER页面，但是在IE中这一项为空，后来查了一些相关资料，发现在IE 中通过 window.location.href 或者是 是无法获取HTTP_REFERER， 真是搞不懂 IE 的浏览器，很多浏览器运行的很好的东西，它就是不支持，最后没有办法，只能PHP伪造来源HTTP_REFERER的方法或者用JS来伪造。<br>
IE可以识别的 HTTP_REFERER 提交是通过click 触发的事件或者是 Form 表单提交的请求，下面是根据网上的资料总结的一个方法：<br>
<script>
function referURL(url){
var isIe=(document.all)?true:false;
if(isIe) {
var linka = document.createElement(’a');
linka.href=url;
document.body.appendChild(linka);
linka.click();
}else {
window.location = url;
}
}</p>
<p>var url=“www.myposts.cn”
referURL(url);
</script></p>
<p>这个方法先是用 document.all 来判断当前的浏览器是否是IE， 如果是的话就生成一个link，然后自动执行 onclick 事件，如果不是的话就用JS 跳转。这样在处理页面就可以得到 HTTP_REFERER 了</p>
<p>此方法在IE, Firefox, Safari , Chrome 测试通过</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1880 post type-post status-publish format-standard hentry category-115" id="post-1880">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1880">各搜索引擎referer关键字，编码</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1880">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>在做商务E流量分析的时候，需要实现一个功能：如果访客是通过搜索引擎的搜索找到客户网站的，要统计出访客是通过哪个搜索引擎访问到页面，并且统计出是通过 什么关键字搜索到该网站的。在网上google一下，发出对这方面的描述文档还是比较少的，在做这个功能的过程中有些经验给人家分享一下。</p>
<p>实现这样的功能，基本原理是获取到来源地址，然后分析其中的内容，把所需要的搜索引擎名称和关键字取出。<br>
获取来源地址很简单，在servlet 中可以通过HttpServletRequest.getHeader(“Referer”)方法取得,jsp页面中可以通过 request.getHeader(“referer”)取得。取得来源地址后便可以通过分析得到的来源地址分析出我们所需要的内容。通常我们常用的搜 索引擎有以下14个。<br>
http://www.google.com;<br>
http://www.google.cn;<br>
http://www.sogou.com;<br>
http://so.163.com;<br>
http://www.iask.com;<br>
http://www.yahoo.com;<br>
http://www.baidu.com;<br>
http://www.3721.com;<br>
http://www.soso.com;<br>
http://www.zhongsou.com;<br>
http://www.alexa.com;<br>
http://www.search.com;<br>
http://www.lycos.com;<br>
http://www.aol.com;</p>
<p>  要获取我们所需要的内容，我们必须分析 各个引擎的特性，由于各个搜索引擎的格式不一样，获取到的来源地址必然也不一致，下面我们来分析一下各种搜索引擎的地址格式。</p>
<p>   在搜索引擎里输入关键字，点击搜索之后地址栏中的内容就是我们通过HttpServletRequest.getHeader(“Referer”)或 request.getHeader(“referer”)取得的来源地址。</p>
<p>google搜索引擎：<br>
http://www.google.com/search?hl= zh-N&amp;newwindow=1&amp;<br>
q=%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80&amp;<br>
btnG= %E6%90%9C%E7%B4%A2&amp;lr=</p>
<p>http://www.google.cn/search?hl= zh-N&amp;newwindow=1&amp;<br>
q=%E6%B0%B8%E5%AE%89%E8%B7%AF%E7%81%AF&amp;<br>
btnG= %E6%90%9C%E7%B4%A2&amp;meta=</p>
<p>从这里我们可以得到我们所需要的搜索引擎名称和关键字。其中，搜索引擎显而易见，是google;而关键字呢？经过我仔细观察、<br>
测试后发现关键字是编码后放 在参数q里，也就是说<br>
%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80和<br>
%E6%B0 %B8%E5%AE%89%E8%B7%AF%E7%81%AF<br>
就是输入的关键字。</p>
<p>(有人会问，那btnG这个参数的值是什么来头,他也编过码 啊?是用来干嘛的呢？呵呵，它什么来头都没有，什么也没干，多余的！你试试输入关键字之后点击搜索按钮看看地址栏，然后再试试输入关键字之后回车，再看看 地址栏，看出两种做法在地址栏中的一点点差别之后你就会明白的啦)</p>
<p>baidu搜索引擎：<br>
(1)http://www.baidu.com/s?ie=gb2312&amp;bs=%CB%B3%B5%C2%BC%D2%BE%DF&amp;sr=&amp;z=&amp;cl=3&amp;f=8&amp;<br>
wd=%BD%F1%BF%C6%BF%C6%BC%BC&amp;ct=0<br>
(2)http://www.baidu.com/baidu?tn=nanlingcb&amp;word=%CB%B3%B5%C2%BC%D2%BE%DF</p>
<p>baidu 搜索引擎，这里需要说明一下，当我们在通过在http://www.baidu.com中 输入搜索关键字，获取的来源地址为(1)字符串；当通过其它方式，比如在一些浏览器插件中输入关键字搜索的获取的来源地址为(2)字符串。通过获取来的这来源地，我也可以很容易的知道当前的搜索引擎是baidu；而关键字呢?看看(1),这里有两个经过编码的字符串，到底哪个是关键字呢？wd的值是关键字！信我啦！那bs的值是什么呢？你输入关键字多搜索几次，看看你有什么发现？发现了吧，bs是你上一次搜索的关键字！这个我们不管，它不是我们所要的东 西。分析得知，在baidu搜索引擎里有两个地方放关键字，一个地方是编码后放在在参数wd里，另外一个地方是编码后放在word参数里。明白了吧？：)</p>
<p>sogou搜索引擎<br>
http://www.sogou.com/web?query=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC<br>
这个就没这么复杂了，我们通过字符串可以知道搜索引擎为sogou，关键字经编码后放在参数query里,这里值为<br>
%BD%F1%BF%C6%D0%C5 %CF%A2%BF%C6%BC%BC,有时候也会附带多一些参数，但附带的这些参数对我们来说是没用的。</p>
<p>163搜索引擎<br>
http://cha.so.163.com/so.php?in=seek&amp;c=26&amp;key=032152284&amp;q=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC<br>
&amp;x=61&amp;y=19<br>
这个也不复杂，分析得知，搜索引擎名称为163,关键字在参数q里,这里值为%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC</p>
<p>yahoo 搜索引擎<br>
http://search.cn.yahoo.com/search?p=%D3%C0%B0%B2%C2%B7%B5%C6&amp;<br>
source=toolbar_yassist_button&amp;pid=58061_1006&amp;ei=gbk</p>
<p>http://search.cn.yahoo.com/search?lp=%E4%B8%AD%E5%B1%B1%E5%8F%A4%E9%95%87%E7%81%AF%E9%A5%B0&amp;<br>
p=%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80&amp;pid=&amp;ei=UTF-8<br>
很容易得到，搜索引擎名称为yahoo,那关键字是哪些呢?关键字是放在参数p里，而参数lp的值跟baidu类似，也是上一次搜索的关键字。</p>
<p>lycos 搜索引擎<br>
http://search.lycos.com/?query=website<br>
这 个我们用得比较少，同样我们通过这个字符串得出搜索引擎为lycos，关键字放在query里.</p>
<p>3721搜索引擎<br>
http://seek.3721.com/index.htm?name=%D6%E9%BA%A3%CF%E3%D6%DE%C0%CD%CE%F1%CA%D0%B3%A1<br>
容 易得到，搜索引擎名称为3721，关键字放在name里</p>
<p>search搜索引擎<br>
http://www.search.com/search?lq=d%25E4%25B8%25AD%25E5%259B%25BDd&amp;<br>
q=%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%9B%BD%E5%92%8C<br>
这 个我们用得很少，也容易得到搜索引擎名称为search,关键字放在p里，而lp放的是什么呢？尚未弄清楚，<br>
反正与我们所要的东西无关。</p>
<p>soso 搜索引擎<br>
http://www.soso.com/q?w=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC12&amp;sc=web&amp;<br>
bs=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC1&amp;ch=w.soso.pr&amp;uin=&amp;lr=chs&amp;web_options=on<br>
可 以看出搜索引擎名称为soso，关键字放在参数w里，需参数bs的值跟baidu相似，是上一次搜索的关键字<br>
zhongsou搜索引擎<br>
http://p.zhongsou.com/p?w=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC&amp;l=&amp;jk=&amp;k=&amp;r=&amp;aid=&amp;pt=1&amp;dt=2<br>
可 以看出搜索引擎名称为zhongsou,关键字在参数w里。</p>
<p>alexa搜索引擎<br>
http://www.alexa.com/search?q=%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80<br>
得出搜索引擎名称为zhongsou，关键字放在参数q里。<br>
    对各种搜索引擎的url的分析已完成，大家都对这些常用的搜索引擎的url的格式有所了解了，下面我们看看怎样从我们所取得的这些字符串中得到我们所要的信息,也就是怎样从这些字符串中提取我们所需的搜索引擎名称和搜索关键字.这里理所当然使用功能强大的正则表达式了.好,现在我们逐个逐个地分析各个搜索引擎用什么正则表达式提取我们所需要的内容.<br>
首先还是先分析 google搜索引擎:<br>
上面已经提到我们取得的google搜索引擎的地址是这样的:<br>
http://www.google.com/search?hl= zh-N&amp;newwindow=1<br>
&amp;q=%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80&amp;<br>
btnG= %E6%90%9C%E7%B4%A2&amp;lr=</p>
<p>http://www.google.cn/search?hl= zh-N&amp;newwindow=1<br>
&amp;q=%E6%B0%B8%E5%AE%89%E8%B7%AF%E7%81%AF&amp;<br>
btnG= %E6%90%9C%E7%B4%A2&amp;meta=</p>
<p>其 实它还有一种形式是这样的:<br>
(3)http://www.google.com/custom?hl=zh-CN&amp;inlang=zh-CN&amp;ie=GB2312&amp;oe=GB2312&amp;newwindow=1&amp;<br>
client=pub3261928361684765&amp;cof=FORID%3A1%3BGL%3A1%3BBGC%3AFFFFFF%3BT%3A%23000000%3BLC%3A<br>
%230000ff%3BVLC%3A%23663399%3BALC%3A%230000ff%3BGALT%3A%23008000%3BGFNT%3A<br>
%230000ff%3BGIMP%3A%230000ff%3BDIV%3A%23336699%3BLBGC%3A336699%3BAH%3Acenter%3B<br>
&amp;q=%C5%B7%C2%FC%D5%D5%C3%F7&amp;lr=<br>
OH,my god,是不是看得头晕了?先不要晕,往下看你就不会觉得晕的啦….</p>
<p>我们仔细观察一下,这三种格式都有一个共通点,大家有没有发现呢?就是 他的格式都是这样的:</p>
<p>http://www.google.[…]/[…]&amp;q= [关键字][…]<br>
[…]表示有一个以上的字符.</p>
<p>就如(2)我们在里面放入一些[]就可以看得更清楚了:<br>
http://www.google.[cn]/[search?hl=zh-CN&amp;newwindow=1]<br>
&amp;q=[%E6%B0%B8%E5%AE%89%E8%B7%AF%E7%81%AF][&amp;btnG=%E6%90%9C%E7%B4%A2&amp;meta=]<br>
看明白了吧?看明白了我们就接下去了.于是我们可以得出google搜索引擎的正则表达式了:</p>
<p>http:\\/\\/www\\.google \\.[a-zA-Z]+\\/.+[\\&amp;\\?]q=[^\\&amp;]*。</p>
<p>   现在解释一下这个正则表达式的意思。<br>
http:\\/ \\/www\\.这一段是匹配http://www.,为什么这里多了这么多\呢?因为字符 ‘/’和字符’.’在正则表达式中有特殊意义,要用’\’对这两个字符转义,’/’通过’\/’转义,相似的.也通过’\.’转义,而字符’\’在 java里也是一个特殊字符,本身也需要转义,所以’\/’写成’\\/’,类似的’\.’写成’\\.’；</p>
<p>接下来google\\.[a-zA-Z]+ \\/.+匹配google.com/search?hl=zh-CN&amp;newwindow=1,这里解释一下[a-zA-Z]+,意思是最少有 一个(包括一个)以上英文字母,[a-zA-Z]表示从a到z,从A到Z的字符,+表示至少一个以上,[\\&amp;\\?]q=[^\\&amp;]*匹配的是&amp;q=%E6%B0%B8%E5%AE%89%E8%B7%AF%E7%81%AF,[\\&amp;\\?],表示字符&amp;或字符?由于&amp;和?都是特殊字符，所以都要用转义符转义,q=[^\\&amp;]*表示q=后面是零个（包括零个）以上的非&amp; 字符,[^\\&amp;]表示不为&amp;的字符,为什么不为&amp;呢，因为&amp;后面的字符也经不再属于参数q的值了，我们要取的是q=之 后，字符&amp;之前的字符串.这个正则表达式的解释就到此了。现在这个正则表达式已经可以从众多的获取过来的来源地址中分辩出哪些是google搜索引擎了，但是有一个问题，假如以后google搜索引擎不是这样，换成http://search.google.com/search?hl=zh-CN&amp;newwindow=1&amp;q=%E6%B0%B8%E5%AE%89%E8%B7%AF%E7%81%AF<br>
&amp;btnG=%E6%90%9C%E7%B4%A2&amp;meta= 呢，</p>
<p>那这个正则表达式就不合适了，怎样能在以后改动之后我们写的正则表达式还适用呢？很简单，我们把它改成这个样子:\\.google\\.[a- zA-Z]+\\/.+[\\&amp;\\?]q=[^\\&amp;]*,意思是我们不必匹配http://www这 一串字符串。这样如果google搜索引擎做了类似http://search.google.com/….. 的修改，我们写的正则表达式也适用了，那假如它把域名也改了就没得说了,:);还有一种情况，在地址栏里输入www.google.com:80/也可以正常访问google,也就是说还有 一种情况就是加端口的访问，这种情况也要考虑到，因此之前我们的正则表达式应改成：\\.google\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=[^\\&amp;]*， (:\\d{1,}){0,1}是什么意思呢？他匹配类似”:80″也就是说冒号(:)后跟1个以上的数字字符，而端口是可选的，并且如果出现只会出现一 次，所以用{0,1}.这个正则表达式的用途是用于获取关键字，所以这里我把关键字部分划分为一个组(这在下面会用到),因此，最终的正则表达式为:</p>
<p>\\.google\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)</p>
<p>对 google搜索引擎已经说得很详细，接下来的我就简略的说说了，原理都差不多的了。</p>
<p>baidu搜索引擎：<br>
分 析得知baidu搜索引擎的正则表达式为：<br>
\\.baidu\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]wd=([^\\&amp;]*) 或<br>
\\.baidu\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]word=([^\\&amp;]*)</p>
<p>sogou 搜索引擎<br>
http://www.sogou.com/web?query=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC<br>
正 则表达式:<br>
\\.sogou\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]query=([^\\&amp;]*)<br>
yahoo搜索引擎<br>
正 则表达式:<br>
\\.yahoo\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]p=([^\\&amp;]*)</p>
<p>lycos 搜索引擎<br>
http://search.lycos.com/?query=website<br>
正 则表达式:<br>
\\.lycos\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.*[\\&amp;\\?]query=([^\\&amp;]*)</p>
<p>3721 搜索引擎<br>
http://seek.3721.com/index.htm?name=%D6%E9%BA%A3%CF%E3%D6%DE%C0%CD%CE%F1%CA%D0%B3%A1<br>
http://seek.3721.com/index.htm?q=%D6%E9%BA%A3%CF%E3%D6%DE%C0%CD%CE%F1%CA%D0%B3%A1<br>
正 则表达式:<br>
\\.3721\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]p=([^\\&amp;]*) 或<br>
\\.3721\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]name=([^\\&amp;]*)</p>
<p>search 搜索引擎<br>
正则表达式:<br>
\\.search\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)<br>
soso搜索引擎<br>
正 则表达式:<br>
\\.soso\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]w=([^\\&amp;]*)<br>
zhongsou搜索引擎<br>
http://p.zhongsou.com/p?w=%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC&amp;l=&amp;jk=&amp;k=&amp;r=&amp;aid=&amp;pt=1&amp;dt=2<br>
正 则表达式:<br>
\\.zhongsou\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]w=([^\\&amp;]*)<br>
alexa搜索引擎<br>
http://www.alexa.com/search?q=%E4%BB%8A%E7%A7%91%E4%BF%A1%E6%81%AF%E7%A7%91%E6%8A%80<br>
正 则表达式:<br>
\\.alexa\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)<br>
iask搜索引擎<br>
正则表达式:<br>
\\.iask\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]k=([^\\&amp;]*) 或<br>
\\.iask\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]_searchkey=([^\\&amp;]*)</p>
<p>好了，正则表达式已经写出来了，事情已经完成一半了。现在我们把话题转一下，等会我们再转回来，现在我们先看看如何获取搜索引擎的名称。同样，也 需要用正则表达式，正则表达式实在太强了：)。<br>
我们可以通过以下的正则表达式匹配到google搜索引擎：<br>
http:\\/\\/.* \\.google\\.com(:\\d{1,}){0,1}\\/或<br>
http:\\/\\/.*\\.google\\.cn(:\\d{1,}){0,1}\\/</p>
<p>类 似的也可以匹配其它搜索引擎，我把他们写在一起:<br>
http:\\/\\/.*\\.(google\\.com(:\\d{1,}){0,1}\\/|google\\.cn(:\\d{1,}){0,1}\\/|<br>
baidu\\.com(:\\d{1,}){0,1}\\/|yahoo\\.com(:\\d{1,}){0,1}\\/|<br>
iask\\.com(:\\d{1,}){0,1}\\/|sogou\\.com(:\\d{1,}){0,1}\\/|<br>
163\\.com(:\\d{1,}){0,1}\\/|lycos\\.com(:\\d{1,}){0,1}\\/|<br>
aol\\.com(:\\d{1,}){0,1}\\/|3721\\.com(:\\d{1,}){0,1}\\/|<br>
search\\.com(:\\d{1,}){0,1}\\/|soso.com(:\\d{1,}){0,1}\\/|<br>
zhongsou\\.com(:\\d{1,}){0,1}\\/|alexa\\.com(:\\d{1,}){0,1}\\/)<br>
通过以下程序可以获取到搜索引擎的名称:<br>
import java.util.regex.*;<br>
public class GetEngine<br>
{<br>
public static void main(String[] arg)<br>
{<br>
   GetEngine engine=new GetEngine();</p>
<p>   String referer=”http://www.baidu.com/s?wd=java%D1%A7%CF%B0%CA%D2″;<br>
   String engineName=engine.getSearchEngine(referer);<br>
   System.out.println(“搜索引擎名称:”+engineName);<br>
}<br>
public String getSearchEngine(String refUrl) {<br>
    if(refUrl.length()&gt;11)<br>
    {<br>
       //p是匹配各种搜索引擎的正则表达式<br>
      Pattern p = Pattern.compile(“http:\\/\\/.*\\.(google\\.com(:\\d{1,}){0,1}\\/|<br>
        google\\.cn(:\\d{1,}){0,1}\\/|baidu\\.com(:\\d{1,}){0,1}\\/|<br>
        yahoo\\.com(:\\d{1,}){0,1}\\/|iask\\.com(:\\d{1,}){0,1}\\/|<br>
        sogou\\.com(:\\d{1,}){0,1}\\/|163\\.com(:\\d{1,}){0,1}\\/|<br>
        lycos\\.com(:\\d{1,}){0,1}\\/|aol\\.com(:\\d{1,}){0,1}\\/|<br>
        3721\\.com(:\\d{1,}){0,1}\\/|search\\.com(:\\d{1,}){0,1}\\/|<br>
        soso.com(:\\d{1,}){0,1}\\/|zhongsou\\.com(:\\d{1,}){0,1}\\/|<br>
        alexa\\.com(:\\d{1,}){0,1}\\/)”);<br>
      Matcher m = p.matcher(refUrl);<br>
      if (m.find())//如果来源地址可以匹配以上的pattern<br>
      {<br>
//因为m.group(0)是域名，m.group(1)才是我们最合适我们所要的<br>
        return insteadCode(m.group(1),”(\\.com(:\\d{1,}){0,1}\\/|\\.cn(:\\d{1,}){0,1}\\/|<br>
\\.org(:\\d{1,}){0,1}\\/)”,””);//把.com,.cn,.org替换为””<br>
      }<br>
    }<br>
    return “未发现搜索引擎”;<br>
}<br>
public String insteadCode(String str,String regEx,String code){<br>
    Pattern p=Pattern.compile(regEx);<br>
    Matcher m=p.matcher(str);<br>
    String s=m.replaceAll(code);<br>
    return s;<br>
}<br>
}</p>
<p>通过以上的代码即可得出搜索引擎名称了，似乎任务完成一大半了。只是接着下来的要做的事情比之前所做的要麻烦点点,麻烦就麻烦在编码上。<br>
现在我样回过头看我们上面写的一大堆各种搜索引擎的正则表达式。<br>
由于这里要大量的字符串操作，这里使用StringBuffer来做字符串的连接。<br>
StringBuffer sb=new StringBuffer();<br>
sb.append(“\\.google\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)”)<br>
.append(“|\\.iask\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]k=([^\\&amp;]*)”)<br>
.append(“|\\.iask\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]_searchkey=([^\\&amp;]*)”)<br>
.append(“|\\.sogou\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]query=([^\\&amp;]*)”)<br>
.append(“|\\.163\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)”)<br>
.append(“|\\.yahoo\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]p=([^\\&amp;]*)”)<br>
.append(“|\\.baidu\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]wd=([^\\&amp;]*)”)<br>
.append(“|\\.baidu\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]word=([^\\&amp;]*)”)<br>
.append(“|\\.lycos\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.*[\\&amp;\\?]query=([^\\&amp;]*)”)<br>
.append(“|\\.aol\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]encquery=([^\\&amp;]*)”)<br>
.append(“|\\.3721\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]p=([^\\&amp;]*)”)<br>
.append(“|\\.3721\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]name=([^\\&amp;]*)”)<br>
.append(“|\\.search\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)”)<br>
.append(“|\\.soso\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]w=([^\\&amp;]*)”)<br>
.append(“|\\.zhongsou\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]w=([^\\&amp;]*)”)<br>
.append(“|\\.alexa\\.[a-zA-Z]+(:\\d{1,}){0,1}\\/.+[\\&amp;\\?]q=([^\\&amp;]*)”);<br>
这个正则表达式是把所有搜索引擎用或”|”连接起来，因为只要匹配其中一个搜索引擎的正则表达式就可以。<br>
前面已经说到，关键字是经过编码 的，我们直接取出的关键字会像%BD%F1%BF%C6%D0%C5%CF%A2%BF%C6%BC%BC12,<br>
这样的关键字我们无法读懂，因些需要对这 些关键进行反编码，这要用到java.net.URLDecoder.decode(String s,String enc),这个方法有两个参数，一个参数是要进行反编码的字符串，另一个是指定的字符集。第一个参数很简单，只要我们把取得的关键放到这个参数里，至于第 二个参数怎样呢？这里我只讨论中文的情况，这些搜索引擎有两种字符集编码方式，一种是UTF-8，另外一种是GBK。<br>
只有GBK一种编码方式的搜 索引擎：<br>
3721，iask，sogou，163，baidu，soso，zhongsou<br>
只有UTF-8一种编码方式的搜索引擎:<br>
lycos,aol,search,alexa<br>
有 两种编码方式的：<br>
google,yahoo<br>
只有一种编码方式的问题容易解决，有两种编码方式的怎办呢？办法总比问题多，其实采用哪一个编码方工，它是有”暗示“的，对于google，大多数情况下它是采用UTF-8的编码方式，我们在浏览器的地址栏上输入www.google.com搜索的都是以这种方式来编码的，但有种情况如：<br>
http://www.google.com/custom?hl=zh-CN&amp;inlang=zh-CN&amp;ie=GB2312&amp;oe=GB2312&amp;newwindow=1&amp;client=pub-3261928361684765&amp;<br>
cof=FORID%3A1%3BGL%3A1%3BBGC%3AFFFFFF%3BT%3A%23000000%3BLC%3A%230000ff<br>
%3BVLC%3A%23663399%3BALC%3A%230000ff%3BGALT%3A%23008000%3BGFNT%3A%230000ff%3BGIMP%3A<br>
%230000ff%3BDIV%3A%23336699%3BLBGC%3A336699%3BAH%3Acenter%3B&amp;q=%C5%B7%C2%FC%D5%D5%C3%F7&amp;lr=</p>
<p>这种情况下就不一定是UTF-8编码了，这种情况下以ie这个参数指定，这里ie=gb2312,所以编码方式为gb2312，而gb2312是gbk的字 集，所以这里我们用gbk而不用gb2312;对于yahoo情况类似，只不过yahoo在大多数情况下使用GBK编码，如：<br>
http://search.cn.yahoo.com/search?p=%C5%B7%C2%FC%BF%C6%BC%BC%CA%B5%D2%B5<br>
&amp;source=toolbar_yassist_button&amp;pid=54554_1006&amp;f=A279_1<br>
就是GBK编码,但这种情况:<br>
http://search.cn.yahoo.com/search?ei=gbk&amp;fr=fp-tab-web-ycn&amp;source=errhint_up_web<br>
&amp;p=%BD%F1%BF%C6&amp;meta=vl%3Dlang_zh-CN%26vl%3Dlang_zh-TW&amp;pid=ysearch<br>
就 用ei参数里指定的纺码方式了,这里有可能指定的是gbk，也有可能指定的是UTF-8。<br>
根据以上的解释，于是有以下的程序来获得各种搜索引擎的关键字:</p>
<p>//Java代码<br>
[code]<br>
package com.mytophome.framework;  </p>
<p>import java.util.regex.*;<br>
import java.net.URLDecoder;<br>
import java.io.*;  </p>
<p>public class GetKeyword {<br>
    public static void main(String[] arg) {<br>
        String referer = &quot;http://www.baidu.com/s?wd=java%D1%A7%CF%B0%CA%D2&quot;;<br>
        if (arg.length != 0) {<br>
            referer = arg[0];<br>
        }<br>
        GetKeyword getKeyword = new GetKeyword();<br>
        String searchEngine = getKeyword.getSearchEngine(referer);<br>
        System.out.println(&quot;searchEngine:&quot; + searchEngine);<br>
        System.out.println(&quot;keyword:&quot; + getKeyword.getKeyword(referer));<br>
    }  </p>
<p>    public String getKeyword(String refererUrl) {<br>
        StringBuffer sb = new StringBuffer();<br>
        if (refererUrl != null) {<br>
            sb.append(&quot;(google\\.[a-zA-Z]+/.+[\\&amp;|\\?]q=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|iask\\.[a-zA-Z]+/.+[\\&amp;|\\?]k=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|iask\\.[a-zA-Z]+/.+[\\&amp;|\\?]_searchkey=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|sogou\\.[a-zA-Z]+/.+[\\&amp;|\\?]query=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|163\\.[a-zA-Z]+/.+[\\&amp;|\\?]q=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|yahoo\\.[a-zA-Z]+/.+[\\&amp;|\\?]p=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|baidu\\.[a-zA-Z]+/.+[\\&amp;|\\?]wd=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|baidu\\.[a-zA-Z]+/.+[\\&amp;|\\?]word=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|lycos\\.[a-zA-Z]+/.*[\\&amp;|\\?]query=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|aol\\.[a-zA-Z]+/.+[\\&amp;|\\?]encquery=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|3721\\.[a-zA-Z]+/.+[\\&amp;|\\?]p=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|3721\\.[a-zA-Z]+/.+[\\&amp;|\\?]name=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|search\\.[a-zA-Z]+/.+[\\&amp;|\\?]q=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|soso\\.[a-zA-Z]+/.+[\\&amp;|\\?]w=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|zhongsou\\.[a-zA-Z]+/.+[\\&amp;|\\?]w=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;|alexa\\.[a-zA-Z]+/.+[\\&amp;|\\?]q=([^\\&amp;]*)&quot;)<br>
                    .append(&quot;)&quot;);<br>
            Pattern p = Pattern.compile(sb.toString());<br>
            Matcher m = p.matcher(refererUrl);<br>
            return decoderKeyword(m, refererUrl);<br>
        }<br>
        return null;<br>
    }  </p>
<p>    /**<br>
     * 添加了百度搜索引擎的编码问题<br>
     * @param m<br>
     * @param refererUrl<br>
     * @return<br>
     */<br>
    public String decoderKeyword(Matcher m, String refererUrl) {<br>
        String keyword = null;<br>
        String encode = &quot;UTF-8&quot;;<br>
        String searchEngine = getSearchEngine(refererUrl);<br>
        if (searchEngine != null) {<br>
            if ((checkCode(&quot;3721|iask|sogou|163|soso|zhongsou&quot;, searchEngine)<br>
                    || (checkCode(&quot;yahoo&quot;, searchEngine) &amp;&amp; !checkCode(&quot;ei=utf-8&quot;,refererUrl.toLowerCase())))<br>
                    || (checkCode(&quot;baidu&quot;, searchEngine) &amp;&amp; !checkCode(&quot;ie=utf-8&quot;, refererUrl.toLowerCase()))) {<br>
                encode = &quot;GBK&quot;;<br>
            }  </p>
<p>            if (m.find()) {<br>
                for (int i = 2; i &lt;= m.groupCount(); i++) {<br>
                    if (m.group(i) != null)// 在这里对关键字分组就用到了<br>
                    {<br>
                        try {<br>
                            keyword = URLDecoder.decode(m.group(i), encode);<br>
                        } catch (UnsupportedEncodingException e) {<br>
                            System.out.println(e.getMessage());<br>
                        }<br>
                        break;<br>
                    }<br>
                }<br>
            }<br>
        }<br>
        return keyword;<br>
    }  </p>
<p>    public String getSearchEngine(String refUrl) {<br>
        if (refUrl.length() &gt; 11) {<br>
            // p是匹配各种搜索引擎的正则表达式<br>
            // p是匹配各种搜索引擎的正则表达式<br>
            Pattern p = Pattern<br>
                    .compile(&quot;http:\\/\\/.*\\.(google\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|google\\.cn(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|baidu\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|yahoo\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|iask\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|sogou\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|163\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|lycos\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|aol\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|3721\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|search\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|soso.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|zhongsou\\.com(:\\d{1,}){0,1}\\/&quot;<br>
                            + &quot;|alexa\\.com(:\\d{1,}){0,1}\\/)&quot;);<br>
            Matcher m = p.matcher(refUrl);<br>
            if (m.find()) {<br>
                return insteadCode(m.group(1),&quot;(\\.com(:\\d{1,}){0,1}\\/|\\.cn(:\\d{1,}){0,1}\\/|\\.org(:\\d{1,}){0,1}\\/)&quot;,&quot;&quot;);<br>
            }<br>
        }<br>
        return &quot;未发现有搜索引擎&quot;;<br>
    }  </p>
<p>    public String insteadCode(String str, String regEx, String code) {<br>
        Pattern p = Pattern.compile(regEx);<br>
        Matcher m = p.matcher(str);<br>
        String s = m.replaceAll(code);<br>
        return s;<br>
    }  </p>
<p>    public boolean checkCode(String regEx, String str) {<br>
        Pattern p = Pattern.compile(regEx);<br>
        Matcher m = p.matcher(str);<br>
        return m.find();<br>
    }  }[/code]</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1878 post type-post status-publish format-standard hentry category-115" id="post-1878">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1878">分析网站原始访问日志</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1878">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>想要知道什么人在什么时候浏览了网站的哪些内容吗？查看Apache的访问日志就可以知道。访问日志是Apache的标准日志，本文详细解释了访问日志的内容以及相关选项的配置。</p>
<p>一、访问日志的格式</p>
<p>　　 Apache内建了记录服务器活动的功能，这就是它的日志功能。这个《Apache日志》系列文章介绍的就是Apache的访问日志、错误日志，以及如何分析日志数据，如何定制Apache日志，如何从日志数据生成统计报表等内容。 </p>
<p>　　 如果Apache的安装方式是默认安装，服务器一运行就会有两个日志文件生成。这两个文件是access_log（在Windows上是access.log）和error_log（在Windows上是error.log）。采用默认安装方式时，这些文件可以在/usr/local/apache/logs下找到；对于Windows系统，这些日志文件将保存在Apache安装目录的logs子目录。不同的包管理器会把日志文件放到各种不同的位置，所以你可能需要找找其他的地方，或者通过配置文件查看这些日志文件配置到了什么地方。</p>
<p>　　 正如其名字所示，访问日志access_log记录了所有对Web服务器的访问活动。下面是访问日志中一个典型的记录： </p>
<p>216.35.116.91 – – [19/Aug/2000:14:47:37 -0400] “GET / HTTP/1.0” 200 654</p>
<p>　　 这行内容由7项构成，上面的例子中有两项空白，但整行内容仍旧分成了7项。</p>
<p>　　 第一项信息是远程主机的地址，即它表明访问网站的究竟是谁。在上面的例子中，访问网站的主机是216.35.116.91。随便说一句，这个地址属于一台名为si3001.inktomi.com的机器（要找出这个信息，可以使用nslookup工具查找DNS），inktomi.com是一家制作Web搜索软件的公司。可以看出，仅仅从日志记录的第一项出发，我们就可以得到有关访问者的不少信息。</p>
<p>　　 默认情况下，第一项信息只是远程主机的IP地址，但我们可以要求Apache查出所有的主机名字，并在日志文件中用主机名字来替代IP地址。然而，这种做法通常不值得推荐，因为它将极大地影响服务器记录日志的速度，从而也就减低了整个网站的效率。另外，有许多工具能够将日志文件中的IP地址转换成主机名字，因此要求Apache记录主机名字替代IP地址是得不偿失的。</p>
<p>　　 然而，如果确实有必要让Apache找出远程主机的名字，那么我们可以使用如下指令： </p>
<p>HostNameLookups on</p>
<p>　　 如果HostNameLookups设置成double而不是on，日志记录程序将对它找到的主机名字进行反向查找，验证该主机名字确实指向了原来出现的IP地址。默认情况下HostNameLookups设置为off。 </p>
<p>　　 上例日志记录中的第二项是空白，用一个“-”占位符替代。实际上绝大多数时候这一项都是如此。这个位置用于记录浏览者的标识，这不只是浏览者的登录名字，而是浏览者的email地址或者其他唯一标识符。这个信息由identd返回，或者直接由浏览器返回。很早的时候，那时Netscape 0.9还占据着统治地位，这个位置往往记录着浏览者的email地址。然而，由于有人用它来收集邮件地址和发送垃圾邮件，所以它未能保留多久，很久之前市场上几乎所有的浏览器就取消了这项功能。因此，到了今天，我们在日志记录的第二项看到email地址的机会已经微乎其微了。 </p>
<p>　　 日志记录的第三项也是空白。这个位置用于记录浏览者进行身份验证时提供的名字。当然，如果网站的某些内容要求用户进行身份验证，那么这项信息是不会空白的。但是，对于大多数网站来说，日志文件的大多数记录中这一项仍旧是空白的。</p>
<p>　　 日志记录的第四项是请求的时间。这个信息用方括号包围，而且采用所谓的“公共日志格式”或“标准英文格式”。因此，上例日志记录表示请求的时间是2000年8月19日星期三14:47:37。时间信息最后的“-0400”表示服务器所处时区位于UTC之前的4小时。 </p>
<p>　　 日志记录的第五项信息或许是整个日志记录中最有用的信息，它告诉我们服务器收到的是一个什么样的请求。该项信息的典型格式是“METHOD RESOURCE PROTOCOL”，即“方法 资源 协议”。 </p>
<p>　　 在上例中，METHOD是GET，其他经常可能出现的METHOD还有POST和HEAD。此外还有不少可能出现的合法METHOD，但主要就是这三种。 </p>
<p>　　 RESOURCE是指浏览者向服务器请求的文档，或URL。在这个例子中，浏览者请求的是“/”，即网站的主页或根。大多数情况下，“/”指向DocumentRoot目录的index.html文档，但根据服务器配置的不同它也可能指向其他文件。 </p>
<p>　　 PROTOCOL通常是HTTP，后面再加上版本号。版本号或者是1.0，或者是1.1，但出现1.0的时候比较多。我们知道，HTTP协议是Web得以工作的基础，HTTP/1.0是HTTP协议的早期版本，而1.1是最近的版本。当前大多数Web客户程序仍使用1.0版本的HTTP协议。 </p>
<p>　　 日志记录的第六项信息是状态代码。它告诉我们请求是否成功，或者遇到了什么样的错误。大多数时候，这项值是200，它表示服务器已经成功地响应浏览器的请求，一切正常。此处不准备给出状态代码的完整清单以及解释它们的含义，请参考相关资料了解这方面的信息。但一般地说，以2开头的状态代码表示成功，以3开头的状态代码表示由于各种不同的原因用户请求被重定向到了其他位置，以4开头的状态代码表示客户端存在某种错误，以5开头的状态代码表示服务器遇到了某个错误。 </p>
<p>　　 日志记录的第七项表示发送给客户端的总字节数。它告诉我们传输是否被打断（即，该数值是否和文件的大小相同）。把日志记录中的这些值加起来就可以得知服务器在一天、一周或者一月内发送了多少数据。</p>
<p>二、配置访问日志</p>
<p>　　 访问日志文件的位置实际上是一个配置选项。如果我们检查httpd.conf配置文件，可以看到该文件中有如下这行内容： </p>
<p>CustomLog /usr/local/apache/logs/access_log common</p>
<p>　　 注意，对于版本较早的Apache服务器，这行内容可能略有不同。它使用的可能不是CustomLog指令，而是TransferLog指令。如果你的服务器属于这类情况，建议你尽可能地早日升级服务器。</p>
<p>　　 CustomLog指令指定了保存日志文件的具体位置以及日志的格式。至于如何定制日志文件的格式以及内容，我们将在这个《Apache日志》系列文章的后面几篇讨论。上面这行指令指定的是common日志格式，自从有了Web服务器开始，common格式就是它的标准格式。由此我们也可以理解，虽然几乎不再有任何客户程序向服务器提供用户的标识信息，但访问日志却还保留着第二项内容。</p>
<p>　　 CustomLog指令中的路径是日志文件的路径。注意，由于日志文件是由HTTP用户打开的（用User指令指定），因此必须注意这个路径要有安全保证，防止该文件被随意改写。</p>
<p>　　 《Apache日志》系列文章的后面几篇将继续介绍：Apache错误日志，定制日志的格式和内容，如何将日志内容写入指定的程序而不是文件，如何从日志文件获得一些非常有用的统计信息，等等。</p>
<p>Apche日志系列(2)：错误日志</p>
<p>错误日志和访问日志一样也是Apache的标准日志。本文分析错误日志的内容，介绍如何设置和错误日志相关的选项，文档错误和CGI错误的分类，以及如何方便地查看日志内容，等等。 </p>
<p>一、位置和内容</p>
<p>　　 前文讨论了Apache的访问日志，包括它的内容、格式和如何设置访问日志有关的选项。本文我们要讨论的是另外一种Apache标准日志——错误日志。 </p>
<p>　　 错误日志无论在格式上还是在内容上都和访问日志不同。然而，错误日志和访问日志一样也提供丰富的信息，我们可以利用这些信息分析服务器的运行情况、哪里出现了问题。</p>
<p>　　 错误日志的文件名字是error_log，但如果是Windows平台，则错误日志的文件名字是error.log。错误日志的位置可以通过ErrorLog指令设置：</p>
<p>ErrorLog logs/error.log</p>
<p>　　 除非文件位置用“/”开头，否则这个文件位置是相对于ServerRoot目录的相对路径。如果Apache采用默认安装方式安装，那么错误日志的位置应该在/usr/local/apache/logs下。但是，如果Apache用某种包管理器安装，错误日志很可能在其他位置。 </p>
<p>　　 正如其名字所示，错误日志记录了服务器运行期间遇到的各种错误，以及一些普通的诊断信息，比如服务器何时启动、何时关闭等。</p>
<p>　　 我们可以设置日志文件记录信息级别的高低，控制日志文件记录信息的数量和类型。这是通过LogLevel指令设置的，该指令默认设置的级别是error，即记录称得上错误的事件。有关该指令中允许设置的各种选项的完整清单，请参见http://www.apache.org/docs/mod/core.html#loglevel的Apache文档。 </p>
<p>　　 大多数情况下，我们在日志文件中见到的内容分属两类：文档错误和CGI错误。但是，错误日志中偶尔也会出现配置错误，另外还有前面提到的服务器启动和关闭信息。</p>
<p>二、文档错误</p>
<p>　　 文档错误和服务器应答中的400系列代码相对应，最常见的就是404错误——Document Not Found（文档没有找到）。除了404错误以外，用户身份验证错误也是一种常见的错误。 </p>
<p>　　 404错误在用户请求的资源（即URL）不存在时出现，它可能是由于用户输入的URL错误，或者由于服务器上原来存在的文档因故被删除或移动。 </p>
<p>　　 顺便说一下，按照Jakob Nielson的意见，在不提供重定向或者其他补救措施的情况下，我们永远不应该移动或者删除Web网站的任何资源。Nielson的更多文章，请参见http://www.zdnet.com/devhead/alertbox/。 </p>
<p>　　 当用户不能打开服务器上的文档时，错误日志中出现的记录如下所示：</p>
<p>[Fri Aug 18 22:36:26 2000] [error]</p>
<p>[client 192.168.1.6] File does not exist:</p>
<p>/usr/local/apache/bugletdocs/Img/south-korea.gif<br>
　　 可以看到，正如访问日志access_log文件一样，错误日志记录也分成多个项。 </p>
<p>　　 错误记录的开头是日期/时间标记，注意它们的格式和access_log中日期/时间的格式不同。access_log中的格式被称为“标准英文格式”，这或许是历史跟我们开的一个玩笑，但现在要改变它已经太迟了。</p>
<p>　　 错误记录的第二项是当前记录的级别，它表明了问题的严重程度。这个级别信息可能是LogLevel指令的文档中所列出的任一级别（参见前面LogLevel的链接），error级别处于warn级别和crit级别之间。404属于error错误级别，这个级别表示确实遇到了问题，但服务器还可以运行。</p>
<p>　　 错误记录的第三项表示用户发出请求时所用的IP地址。</p>
<p>　　 记录的最后一项才是真正的错误信息。对于404错误，它还给出了完整路径指示服务器试图访问的文件。当我们料想某个文件应该在目标位置却出现了404错误时，这个信息是非常有用的。此时产生这种错误的原因往往是由于服务器配置错误、文件实际所处的虚拟主机和我们料想的不同，或者其他一些意料不到的情况。</p>
<p>　　 由于用户身份验证问题而出现的错误记录如下所示： </p>
<p>[Tue Apr 11 22:13:21 2000]</p>
<p>[error] [client 192.168.1.3] user rbowen@rcbowen.</p>
<p>com: authentication failure for “/cgi-bin/hirecareers/company.cgi”:</p>
<p>password mismatch</p>
<p>　　 注意，由于文档错误是用户请求的直接结果，因此它们在访问日志中也会有相应的记录。</p>
<p>三、CGI错误<br>
　　 错误日志最主要的用途或许是诊断行为异常的CGI程序。为了进一步分析和处理方便，CGI程序输出到STDERR（Standard Error，标准错误设备）的所有内容都将直接进入错误日志。这意味着，任何编写良好的CGI程序，如果出现了问题，错误日志就会告诉我们有关问题的详细信息。</p>
<p>　　 然而，把CGI程序错误输出到错误日志也有它的缺点，错误日志中将出现许多没有标准格式的内容，这使得用错误日志自动分析程序从中分析出有用的信息变得相当困难。</p>
<p>　　 下面是一个例子，它是调试Perl CGI代码时，错误日志中出现的一个错误记录： </p>
<p>[Wed Jun 14 16:16:37 2000] [error] [client 192.168.1.3] Premature</p>
<p>end of script headers: /usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi</p>
<p>Global symbol “$rv” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 81.</p>
<p>Global symbol “�tails” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 84.</p>
<p>Global symbol “$Config” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 133.</p>
<p>Execution of /usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi</p>
<p>aborted due to compilation errors.</p>
<p>　　 可以看到，CGI错误和前面的404错误格式相同，包含日期/时间、错误级别以及客户地址、错误信息。但这个CGI错误的错误信息有好几行，这往往会干扰一些错误日志分析软件的工作。</p>
<p>　　 有了这个错误信息，即使是对Perl不太熟悉的人也能够找出许多有关错误的信息，例如至少可以方便地得知是哪几行代码出现了问题。Perl在报告程序错误方面的机制是相当完善的。当然，不同的编程语言输出到错误日志的信息会有所不同。</p>
<p>　　 由于CGI程序运行环境的特殊性，如果没有错误日志的帮助，大多数CGI程序的错误都将很难解决。 </p>
<p>　　 有不少人在邮件列表或者新闻组中抱怨说自己有一个CGI程序，当打开网页时服务器却返回错误，比如“Internal Server Error”。我们可以肯定，这些人还没有看过服务器的错误日志，或者根本不知道错误日志的存在。决多大多数情况下，错误日志能够精确地指出CGI错误的所在以及如何修正这个错误。 </p>
<p>四、查看日志文件</p>
<p>　　 我常常告诉别人说，在进行开发的同时我会不断地检查服务器的日志，以便能够立即知道哪儿出了问题。但我得到的回答却往往是沉默。起先我以为这种沉默意味着“你当然得这样做”，后来我才发现这种沉默的真正含义是“我不知道别人的做法，但我自己是不干的。”</p>
<p>　　 虽然如此，下面我们还是要看看如何方便地查看服务器日志文件。用telnet连接到服务器，然后输入下面的命令： </p>
<p>tail -f /usr/local/apache/logs/error_log</p>
<p>　　 该命令将显示出日志文件的最后几行内容，如果有新的内容加入到日志文件，它还会立即显示出新加入的内容。</p>
<p>　　 Windows用户也同样可以使用这种方法，比如可以使用各种为Windows提供的Unix工具软件包。我个人爱好一个称为AINTX的工具，它可以在http://maxx.mc.net/~jlh/nttools/index.htm找到。</p>
<p>　　 还有一种替代方法是使用下面的Perl代码，它利用了一个称为File::Tail的模块：</p>
<p>use File::Tail;</p>
<p>$file=File::Tail-&gt;;new(“/some/log/file”);</p>
<p>while (defined($line=$file-&gt;;read)) {</p>
<p>print “$line”;</p>
<p>}</p>
<p>　　 无论具体采用的是哪一种方法，同时打开多个终端窗口都是一种好习惯：比如在一个窗口中显示错误日志，在另一个窗口中显示访问日志。这样，我们就能够随时获知网站上发生的事情并立即予以解决。</p>
<p>　　 在这个《Apache日志》系列的下一篇文章中，我们将讨论定制服务器日志，即如何在日志文件中记录所有我们想要的信息，排除所有我们不想要的信息。</p>
<p>　　 在此之后，我们还将讨论日志文件的处理，即如何从日志文件生成统计报表。在最后几篇文章中，我们还将讨论如何把日志记录重定向到指定的程序而不是保存到日志文件，以便由程序实时地处理新生成的日志数据，比如将日志数据保存到数据库，或者当发生某些关键性错误时通过email把日志信息发送给系统管理员，等等。 </p>
<p>Apche日志系列(3)：定制日志</p>
<p>有时候我们需要定制Apache默认日志的格式和内容，比如增加或减少日志所记录的信息、改变默认日志文件的格式等。本文介绍可以用日志记录的所有信息，以及如何设置Apache使其记录这些信息。 </p>
<p>一、定义日志格式(4月3日)</p>
<p>　　 很久以前，日志文件只有一种格式，这就是“公共格式”，许多人已经习惯于使用这种格式。随后出现了定制日志格式，而且看起来定制日志格式更很受欢迎，即使公共日志格式本身也重新用定制日志格式定义。本文介绍的就是如何随心所欲地定制日志文件的格式、如何让日志文件记录自己想要的信息。</p>
<p>　　 定制日志文件的格式涉及到两个指令，即LogFormat指令和CustomLog指令，默认httpd.conf文件提供了关于这两个指令的几个示例。 </p>
<p>　　 LogFormat指令定义格式并为格式指定一个名字，以后我们就可以直接引用这个名字。CustomLog指令设置日志文件，并指明日志文件所用的格式（通常通过格式的名字）。</p>
<p>　　 LogFormat指令的功能是定义日志格式并为它指定一个名字。例如，在默认的httpd.conf文件中，我们可以找到下面这行代码： </p>
<p>LogFormat “%h %l %u %t \”%r\” %&gt;;s %b” common</p>
<p>　　 该指令创建了一种名为“common”的日志格式，日志的格式在双引号包围的内容中指定。格式字符串中的每一个变量代表着一项特定的信息，这些信息按照格式串规定的次序写入到日志文件。</p>
<p>　　 Apache文档已经给出了所有可用于格式串的变量及其含义，下面是其译文：</p>
<p>———————————————————————-</p>
<p>%…a: 远程IP地址 </p>
<p>%…A: 本地IP地址 </p>
<p>%…B: 已发送的字节数，不包含HTTP头</p>
<p>%…b: CLF格式的已发送字节数量，不包含HTTP头。</p>
<p>例如当没有发送数据时，写入‘-’而不是0。 </p>
<p>%e: 环境变量FOOBAR的内容 </p>
<p>%…f: 文件名字 </p>
<p>%…h: 远程主机 </p>
<p>%…H 请求的协议 </p>
<p>%i: Foobar的内容，发送给服务器的请求的标头行。 </p>
<p>%…l: 远程登录名字（来自identd，如提供的话）</p>
<p>%…m 请求的方法 </p>
<p>%n: 来自另外一个模块的注解“Foobar”的内容</p>
<p>%o: Foobar的内容，应答的标头行 </p>
<p>%…p: 服务器响应请求时使用的端口 </p>
<p>%…P: 响应请求的子进程ID。</p>
<p>%…q 查询字符串（如果存在查询字符串，则包含“?”后面的</p>
<p>部分；否则，它是一个空字符串。）</p>
<p>%…r: 请求的第一行 </p>
<p>%…s: 状态。对于进行内部重定向的请求，这是指*原来*请求 </p>
<p>的状态。如果用%…&gt;;s，则是指后来的请求。 </p>
<p>%…t: 以公共日志时间格式表示的时间（或称为标准英文格式） </p>
<p>%t: 以指定格式format表示的时间 </p>
<p>%…T: 为响应请求而耗费的时间，以秒计 </p>
<p>%…u: 远程用户（来自auth；如果返回状态（%s）是401则可能是伪造的） </p>
<p>%…U: 用户所请求的URL路径 </p>
<p>%…v: 响应请求的服务器的ServerName</p>
<p>%…V: 依照UseCanonicalName设置得到的服务器名字 </p>
<p>——————————————————————</p>
<p>　　 在所有上面列出的变量中，“…”表示一个可选的条件。如果没有指定条件，则变量的值将以“-”取代。分析前面来自默认httpd.conf文件的LogFormat指令示例，可以看出它创建了一种名为“common”的日志格式，其中包括：远程主机，远程登录名字，远程用户，请求时间，请求的第一行代码，请求状态，以及发送的字节数。</p>
<p>　　 有时候我们只想在日志中记录某些特定的、已定义的信息，这时就要用到“…”。如果在“%”和变量之间放入了一个或者多个HTTP状态代码，则只有当请求返回的状态代码属于指定的状态代码之一时，变量所代表的内容才会被记录。例如，如果我们想要记录的是网站的所有无效链接，那么可以使用：</p>
<p>—————————————————-</p>
<p>LogFormat @4{Referer}i BrokenLinks</p>
<p>—————————————————</p>
<p>　　 反之，如果我们想要记录那些状态代码不等于指定值的请求，只需加入一个“!”符号即可： </p>
<p>LogFormat %!200U SomethingWrong</p>
<p>Apche日志系列(4)：日志分析</p>
<p>尽管日志文件中包含着大量有用的信息，但这些信息只有在经过深入挖掘之后才能够最大限度地发挥作用。本文首先讨论了能够从日志文件获得的信息以及不能从日志文件获得的信息，然后介绍了几种优秀的日志分析工具以及如何自己编程分析日志文件。</p>
<p>一、可以得到哪些信息(4月4日)</p>
<p>　　 在这个《Apache日志》系列文章的前面几篇中，我们讨论了Apache的标准日志文件——访问日志和错误日志，以及如何定制日志文件。本文接下来讨论如何分析日志文件获得宝贵的统计信息。</p>
<p>　　 我们面临的问题是，虽然日志文件中包含了大量的信息，但这些信息对于我们管理、规划网站却没有多少直接的帮助。为了管理和规划网站，我们需要知道：有多少人浏览了网站，他们在看些什么，停留了多长时间，他们从哪里得知这个网站，等等。所有这些信息就隐藏于（或者可能隐藏于）日志文件之中。</p>
<p>　　 就网站的经营者而言，他们还希望知道浏览者的姓名、地址、鞋子大小，甚至还有浏览者的信用卡号码，但这些信息都不可能从日志文件中得到。为此，作为技术人员的我们就必须知道如何向这些经营者解释清楚：这部分信息不仅不可能从日志文件获得，而且要获得这些信息的唯一方法是直接向浏览者本人询问，并作好被拒绝的准备。</p>
<p>　　 有许多信息可以用日志文件来记录，其中包括： </p>
<p>远程机器的地址：“远程机器的地址”和“谁在浏览网站”差不多，但并不等同。具体地说，远程机器的地址告诉我们浏览者来自何方，比如它可能是buglet.rcbowen.com或者proxy01.aol.com。 </p>
<p>浏览时间：浏览者何时开始访问网站？从这个问题的答案中我们能够了解不少情况。如果网站的大多数浏览者都在早上9:00和下午4:00之间访问网站，那么可以相信网站的浏览者大多数总在工作时间进行访问；如果访问记录大多出现在下午7:00到午夜之间，我们可以肯定浏览者一般在家里上网。 当然，从单个访问记录能够得到的信息非常有限，但如果从数千个访问记录出发，我们就可以得到非常有用和重要的统计信息。</p>
<p>用户所访问的资源：网站的哪些部分最受用户欢迎？这些最受欢迎的部分就是我们应该继续加以发展的部分。网站的哪些部分总是受到冷落？网站中这些受到冷落的部分或许隐藏得太深，或许它们确实没有什么意思，此时我们就得想办法加以改进。当然，网站还有的内容，比如法律上的声明，虽然很少有人访问，但却不应该随便地改动它们。</p>
<p>无效链接：当然，日志文件还能够告诉我们哪些东西不能按照我们所想象地运行。网站中是否存在错误的链接？其他网站链接过来时有没有搞错URL？是否存在不能正常运行的CGI程序？是否有搜索引擎检索程序每秒发出数千个请求，从而影响了本网站的正常服务？这些问题的答案都可以从日志文件找到线索<br>
1,查看apache进程:<br>
ps aux | grep httpd | grep -v grep | wc -l<br>
2,查看80端口的tcp连接:<br>
netstat -tan | grep “ESTABLISHED” | grep “:80” | wc -l<br>
3,通过日志查看当天ip连接数，过滤重复:<br>
cat access_log | grep “20/Oct/2008” | awk ‘{print $1}’ | sort | uniq -c | sort -rn<br>
4,当天ip连接数最高的ip都在干些什么(原来是蜘蛛):<br>
cat access_log | grep “20/Oct/2008:00” | grep “122.102.7.212” | awk ‘{print $7}’ | sort | uniq -c | sort -rn | head -n 10<br>
5,当天访问页面排前10的url:<br>
cat access_log | awk ‘{if($8 ~ /HTTP\/1.1/)print $7}’ | sort | uniq -c | sort -nr | head -n 10<br>
6,用tcpdump嗅探80端口的访问看看谁最高<br>
tcpdump -i eth0 -t dst port 80 -c 1000 | awk -F”.” ‘{print $1″.”$2″.”$3″.”$4}’ | sort | uniq -c | sort –rn<br>
7,查看某一时间段的ip连接数:<br>
grep “2006:0[7-8]” access_log | awk ‘{print $2}’ | sort | uniq -c| sort -nr | wc -l想要知道什么人在什么时候浏览了网站的哪些内容吗？查看Apache的访问日志就可以知道。访问日志是Apache的标准日志，本文详细解释了访问日志的内容以及相关选项的配置。</p>
<p>一、访问日志的格式</p>
<p>　　 Apache内建了记录服务器活动的功能，这就是它的日志功能。这个《Apache日志》系列文章介绍的就是Apache的访问日志、错误日志，以及如何分析日志数据，如何定制Apache日志，如何从日志数据生成统计报表等内容。 </p>
<p>　　 如果Apache的安装方式是默认安装，服务器一运行就会有两个日志文件生成。这两个文件是access_log（在Windows上是access.log）和error_log（在Windows上是error.log）。采用默认安装方式时，这些文件可以在/usr/local/apache/logs下找到；对于Windows系统，这些日志文件将保存在Apache安装目录的logs子目录。不同的包管理器会把日志文件放到各种不同的位置，所以你可能需要找找其他的地方，或者通过配置文件查看这些日志文件配置到了什么地方。</p>
<p>　　 正如其名字所示，访问日志access_log记录了所有对Web服务器的访问活动。下面是访问日志中一个典型的记录： </p>
<p>216.35.116.91 – – [19/Aug/2000:14:47:37 -0400] “GET / HTTP/1.0” 200 654</p>
<p>　　 这行内容由7项构成，上面的例子中有两项空白，但整行内容仍旧分成了7项。</p>
<p>　　 第一项信息是远程主机的地址，即它表明访问网站的究竟是谁。在上面的例子中，访问网站的主机是216.35.116.91。随便说一句，这个地址属于一台名为si3001.inktomi.com的机器（要找出这个信息，可以使用nslookup工具查找DNS），inktomi.com是一家制作Web搜索软件的公司。可以看出，仅仅从日志记录的第一项出发，我们就可以得到有关访问者的不少信息。</p>
<p>　　 默认情况下，第一项信息只是远程主机的IP地址，但我们可以要求Apache查出所有的主机名字，并在日志文件中用主机名字来替代IP地址。然而，这种做法通常不值得推荐，因为它将极大地影响服务器记录日志的速度，从而也就减低了整个网站的效率。另外，有许多工具能够将日志文件中的IP地址转换成主机名字，因此要求Apache记录主机名字替代IP地址是得不偿失的。</p>
<p>　　 然而，如果确实有必要让Apache找出远程主机的名字，那么我们可以使用如下指令： </p>
<p>HostNameLookups on</p>
<p>　　 如果HostNameLookups设置成double而不是on，日志记录程序将对它找到的主机名字进行反向查找，验证该主机名字确实指向了原来出现的IP地址。默认情况下HostNameLookups设置为off。 </p>
<p>　　 上例日志记录中的第二项是空白，用一个“-”占位符替代。实际上绝大多数时候这一项都是如此。这个位置用于记录浏览者的标识，这不只是浏览者的登录名字，而是浏览者的email地址或者其他唯一标识符。这个信息由identd返回，或者直接由浏览器返回。很早的时候，那时Netscape 0.9还占据着统治地位，这个位置往往记录着浏览者的email地址。然而，由于有人用它来收集邮件地址和发送垃圾邮件，所以它未能保留多久，很久之前市场上几乎所有的浏览器就取消了这项功能。因此，到了今天，我们在日志记录的第二项看到email地址的机会已经微乎其微了。 </p>
<p>　　 日志记录的第三项也是空白。这个位置用于记录浏览者进行身份验证时提供的名字。当然，如果网站的某些内容要求用户进行身份验证，那么这项信息是不会空白的。但是，对于大多数网站来说，日志文件的大多数记录中这一项仍旧是空白的。</p>
<p>　　 日志记录的第四项是请求的时间。这个信息用方括号包围，而且采用所谓的“公共日志格式”或“标准英文格式”。因此，上例日志记录表示请求的时间是2000年8月19日星期三14:47:37。时间信息最后的“-0400”表示服务器所处时区位于UTC之前的4小时。 </p>
<p>　　 日志记录的第五项信息或许是整个日志记录中最有用的信息，它告诉我们服务器收到的是一个什么样的请求。该项信息的典型格式是“METHOD RESOURCE PROTOCOL”，即“方法 资源 协议”。 </p>
<p>　　 在上例中，METHOD是GET，其他经常可能出现的METHOD还有POST和HEAD。此外还有不少可能出现的合法METHOD，但主要就是这三种。 </p>
<p>　　 RESOURCE是指浏览者向服务器请求的文档，或URL。在这个例子中，浏览者请求的是“/”，即网站的主页或根。大多数情况下，“/”指向DocumentRoot目录的index.html文档，但根据服务器配置的不同它也可能指向其他文件。 </p>
<p>　　 PROTOCOL通常是HTTP，后面再加上版本号。版本号或者是1.0，或者是1.1，但出现1.0的时候比较多。我们知道，HTTP协议是Web得以工作的基础，HTTP/1.0是HTTP协议的早期版本，而1.1是最近的版本。当前大多数Web客户程序仍使用1.0版本的HTTP协议。 </p>
<p>　　 日志记录的第六项信息是状态代码。它告诉我们请求是否成功，或者遇到了什么样的错误。大多数时候，这项值是200，它表示服务器已经成功地响应浏览器的请求，一切正常。此处不准备给出状态代码的完整清单以及解释它们的含义，请参考相关资料了解这方面的信息。但一般地说，以2开头的状态代码表示成功，以3开头的状态代码表示由于各种不同的原因用户请求被重定向到了其他位置，以4开头的状态代码表示客户端存在某种错误，以5开头的状态代码表示服务器遇到了某个错误。 </p>
<p>　　 日志记录的第七项表示发送给客户端的总字节数。它告诉我们传输是否被打断（即，该数值是否和文件的大小相同）。把日志记录中的这些值加起来就可以得知服务器在一天、一周或者一月内发送了多少数据。</p>
<p>二、配置访问日志</p>
<p>　　 访问日志文件的位置实际上是一个配置选项。如果我们检查httpd.conf配置文件，可以看到该文件中有如下这行内容： </p>
<p>CustomLog /usr/local/apache/logs/access_log common</p>
<p>　　 注意，对于版本较早的Apache服务器，这行内容可能略有不同。它使用的可能不是CustomLog指令，而是TransferLog指令。如果你的服务器属于这类情况，建议你尽可能地早日升级服务器。</p>
<p>　　 CustomLog指令指定了保存日志文件的具体位置以及日志的格式。至于如何定制日志文件的格式以及内容，我们将在这个《Apache日志》系列文章的后面几篇讨论。上面这行指令指定的是common日志格式，自从有了Web服务器开始，common格式就是它的标准格式。由此我们也可以理解，虽然几乎不再有任何客户程序向服务器提供用户的标识信息，但访问日志却还保留着第二项内容。</p>
<p>　　 CustomLog指令中的路径是日志文件的路径。注意，由于日志文件是由HTTP用户打开的（用User指令指定），因此必须注意这个路径要有安全保证，防止该文件被随意改写。</p>
<p>　　 《Apache日志》系列文章的后面几篇将继续介绍：Apache错误日志，定制日志的格式和内容，如何将日志内容写入指定的程序而不是文件，如何从日志文件获得一些非常有用的统计信息，等等。</p>
<p>Apche日志系列(2)：错误日志</p>
<p>错误日志和访问日志一样也是Apache的标准日志。本文分析错误日志的内容，介绍如何设置和错误日志相关的选项，文档错误和CGI错误的分类，以及如何方便地查看日志内容，等等。 </p>
<p>一、位置和内容</p>
<p>　　 前文讨论了Apache的访问日志，包括它的内容、格式和如何设置访问日志有关的选项。本文我们要讨论的是另外一种Apache标准日志——错误日志。 </p>
<p>　　 错误日志无论在格式上还是在内容上都和访问日志不同。然而，错误日志和访问日志一样也提供丰富的信息，我们可以利用这些信息分析服务器的运行情况、哪里出现了问题。</p>
<p>　　 错误日志的文件名字是error_log，但如果是Windows平台，则错误日志的文件名字是error.log。错误日志的位置可以通过ErrorLog指令设置：</p>
<p>ErrorLog logs/error.log</p>
<p>　　 除非文件位置用“/”开头，否则这个文件位置是相对于ServerRoot目录的相对路径。如果Apache采用默认安装方式安装，那么错误日志的位置应该在/usr/local/apache/logs下。但是，如果Apache用某种包管理器安装，错误日志很可能在其他位置。 </p>
<p>　　 正如其名字所示，错误日志记录了服务器运行期间遇到的各种错误，以及一些普通的诊断信息，比如服务器何时启动、何时关闭等。</p>
<p>　　 我们可以设置日志文件记录信息级别的高低，控制日志文件记录信息的数量和类型。这是通过LogLevel指令设置的，该指令默认设置的级别是error，即记录称得上错误的事件。有关该指令中允许设置的各种选项的完整清单，请参见http://www.apache.org/docs/mod/core.html#loglevel的Apache文档。 </p>
<p>　　 大多数情况下，我们在日志文件中见到的内容分属两类：文档错误和CGI错误。但是，错误日志中偶尔也会出现配置错误，另外还有前面提到的服务器启动和关闭信息。</p>
<p>二、文档错误</p>
<p>　　 文档错误和服务器应答中的400系列代码相对应，最常见的就是404错误——Document Not Found（文档没有找到）。除了404错误以外，用户身份验证错误也是一种常见的错误。 </p>
<p>　　 404错误在用户请求的资源（即URL）不存在时出现，它可能是由于用户输入的URL错误，或者由于服务器上原来存在的文档因故被删除或移动。 </p>
<p>　　 顺便说一下，按照Jakob Nielson的意见，在不提供重定向或者其他补救措施的情况下，我们永远不应该移动或者删除Web网站的任何资源。Nielson的更多文章，请参见http://www.zdnet.com/devhead/alertbox/。 </p>
<p>　　 当用户不能打开服务器上的文档时，错误日志中出现的记录如下所示：</p>
<p>[Fri Aug 18 22:36:26 2000] [error]</p>
<p>[client 192.168.1.6] File does not exist:</p>
<p>/usr/local/apache/bugletdocs/Img/south-korea.gif<br>
　　 可以看到，正如访问日志access_log文件一样，错误日志记录也分成多个项。 </p>
<p>　　 错误记录的开头是日期/时间标记，注意它们的格式和access_log中日期/时间的格式不同。access_log中的格式被称为“标准英文格式”，这或许是历史跟我们开的一个玩笑，但现在要改变它已经太迟了。</p>
<p>　　 错误记录的第二项是当前记录的级别，它表明了问题的严重程度。这个级别信息可能是LogLevel指令的文档中所列出的任一级别（参见前面LogLevel的链接），error级别处于warn级别和crit级别之间。404属于error错误级别，这个级别表示确实遇到了问题，但服务器还可以运行。</p>
<p>　　 错误记录的第三项表示用户发出请求时所用的IP地址。</p>
<p>　　 记录的最后一项才是真正的错误信息。对于404错误，它还给出了完整路径指示服务器试图访问的文件。当我们料想某个文件应该在目标位置却出现了404错误时，这个信息是非常有用的。此时产生这种错误的原因往往是由于服务器配置错误、文件实际所处的虚拟主机和我们料想的不同，或者其他一些意料不到的情况。</p>
<p>　　 由于用户身份验证问题而出现的错误记录如下所示： </p>
<p>[Tue Apr 11 22:13:21 2000]</p>
<p>[error] [client 192.168.1.3] user rbowen@rcbowen.</p>
<p>com: authentication failure for “/cgi-bin/hirecareers/company.cgi”:</p>
<p>password mismatch</p>
<p>　　 注意，由于文档错误是用户请求的直接结果，因此它们在访问日志中也会有相应的记录。</p>
<p>三、CGI错误<br>
　　 错误日志最主要的用途或许是诊断行为异常的CGI程序。为了进一步分析和处理方便，CGI程序输出到STDERR（Standard Error，标准错误设备）的所有内容都将直接进入错误日志。这意味着，任何编写良好的CGI程序，如果出现了问题，错误日志就会告诉我们有关问题的详细信息。</p>
<p>　　 然而，把CGI程序错误输出到错误日志也有它的缺点，错误日志中将出现许多没有标准格式的内容，这使得用错误日志自动分析程序从中分析出有用的信息变得相当困难。</p>
<p>　　 下面是一个例子，它是调试Perl CGI代码时，错误日志中出现的一个错误记录： </p>
<p>[Wed Jun 14 16:16:37 2000] [error] [client 192.168.1.3] Premature</p>
<p>end of script headers: /usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi</p>
<p>Global symbol “$rv” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 81.</p>
<p>Global symbol “�tails” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 84.</p>
<p>Global symbol “$Config” requires explicit package name at</p>
<p>/usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi line 133.</p>
<p>Execution of /usr/local/apache/cgi-bin/HyperCalPro/announcement.cgi</p>
<p>aborted due to compilation errors.</p>
<p>　　 可以看到，CGI错误和前面的404错误格式相同，包含日期/时间、错误级别以及客户地址、错误信息。但这个CGI错误的错误信息有好几行，这往往会干扰一些错误日志分析软件的工作。</p>
<p>　　 有了这个错误信息，即使是对Perl不太熟悉的人也能够找出许多有关错误的信息，例如至少可以方便地得知是哪几行代码出现了问题。Perl在报告程序错误方面的机制是相当完善的。当然，不同的编程语言输出到错误日志的信息会有所不同。</p>
<p>　　 由于CGI程序运行环境的特殊性，如果没有错误日志的帮助，大多数CGI程序的错误都将很难解决。 </p>
<p>　　 有不少人在邮件列表或者新闻组中抱怨说自己有一个CGI程序，当打开网页时服务器却返回错误，比如“Internal Server Error”。我们可以肯定，这些人还没有看过服务器的错误日志，或者根本不知道错误日志的存在。决多大多数情况下，错误日志能够精确地指出CGI错误的所在以及如何修正这个错误。 </p>
<p>四、查看日志文件</p>
<p>　　 我常常告诉别人说，在进行开发的同时我会不断地检查服务器的日志，以便能够立即知道哪儿出了问题。但我得到的回答却往往是沉默。起先我以为这种沉默意味着“你当然得这样做”，后来我才发现这种沉默的真正含义是“我不知道别人的做法，但我自己是不干的。”</p>
<p>　　 虽然如此，下面我们还是要看看如何方便地查看服务器日志文件。用telnet连接到服务器，然后输入下面的命令： </p>
<p>tail -f /usr/local/apache/logs/error_log</p>
<p>　　 该命令将显示出日志文件的最后几行内容，如果有新的内容加入到日志文件，它还会立即显示出新加入的内容。</p>
<p>　　 Windows用户也同样可以使用这种方法，比如可以使用各种为Windows提供的Unix工具软件包。我个人爱好一个称为AINTX的工具，它可以在http://maxx.mc.net/~jlh/nttools/index.htm找到。</p>
<p>　　 还有一种替代方法是使用下面的Perl代码，它利用了一个称为File::Tail的模块：</p>
<p>use File::Tail;</p>
<p>$file=File::Tail-&gt;;new(“/some/log/file”);</p>
<p>while (defined($line=$file-&gt;;read)) {</p>
<p>print “$line”;</p>
<p>}</p>
<p>　　 无论具体采用的是哪一种方法，同时打开多个终端窗口都是一种好习惯：比如在一个窗口中显示错误日志，在另一个窗口中显示访问日志。这样，我们就能够随时获知网站上发生的事情并立即予以解决。</p>
<p>　　 在这个《Apache日志》系列的下一篇文章中，我们将讨论定制服务器日志，即如何在日志文件中记录所有我们想要的信息，排除所有我们不想要的信息。</p>
<p>　　 在此之后，我们还将讨论日志文件的处理，即如何从日志文件生成统计报表。在最后几篇文章中，我们还将讨论如何把日志记录重定向到指定的程序而不是保存到日志文件，以便由程序实时地处理新生成的日志数据，比如将日志数据保存到数据库，或者当发生某些关键性错误时通过email把日志信息发送给系统管理员，等等。 </p>
<p>Apche日志系列(3)：定制日志</p>
<p>有时候我们需要定制Apache默认日志的格式和内容，比如增加或减少日志所记录的信息、改变默认日志文件的格式等。本文介绍可以用日志记录的所有信息，以及如何设置Apache使其记录这些信息。 </p>
<p>一、定义日志格式(4月3日)</p>
<p>　　 很久以前，日志文件只有一种格式，这就是“公共格式”，许多人已经习惯于使用这种格式。随后出现了定制日志格式，而且看起来定制日志格式更很受欢迎，即使公共日志格式本身也重新用定制日志格式定义。本文介绍的就是如何随心所欲地定制日志文件的格式、如何让日志文件记录自己想要的信息。</p>
<p>　　 定制日志文件的格式涉及到两个指令，即LogFormat指令和CustomLog指令，默认httpd.conf文件提供了关于这两个指令的几个示例。 </p>
<p>　　 LogFormat指令定义格式并为格式指定一个名字，以后我们就可以直接引用这个名字。CustomLog指令设置日志文件，并指明日志文件所用的格式（通常通过格式的名字）。</p>
<p>　　 LogFormat指令的功能是定义日志格式并为它指定一个名字。例如，在默认的httpd.conf文件中，我们可以找到下面这行代码： </p>
<p>LogFormat “%h %l %u %t \”%r\” %&gt;;s %b” common</p>
<p>　　 该指令创建了一种名为“common”的日志格式，日志的格式在双引号包围的内容中指定。格式字符串中的每一个变量代表着一项特定的信息，这些信息按照格式串规定的次序写入到日志文件。</p>
<p>　　 Apache文档已经给出了所有可用于格式串的变量及其含义，下面是其译文：</p>
<p>———————————————————————-</p>
<p>%…a: 远程IP地址 </p>
<p>%…A: 本地IP地址 </p>
<p>%…B: 已发送的字节数，不包含HTTP头</p>
<p>%…b: CLF格式的已发送字节数量，不包含HTTP头。</p>
<p>例如当没有发送数据时，写入‘-’而不是0。 </p>
<p>%e: 环境变量FOOBAR的内容 </p>
<p>%…f: 文件名字 </p>
<p>%…h: 远程主机 </p>
<p>%…H 请求的协议 </p>
<p>%i: Foobar的内容，发送给服务器的请求的标头行。 </p>
<p>%…l: 远程登录名字（来自identd，如提供的话）</p>
<p>%…m 请求的方法 </p>
<p>%n: 来自另外一个模块的注解“Foobar”的内容</p>
<p>%o: Foobar的内容，应答的标头行 </p>
<p>%…p: 服务器响应请求时使用的端口 </p>
<p>%…P: 响应请求的子进程ID。</p>
<p>%…q 查询字符串（如果存在查询字符串，则包含“?”后面的</p>
<p>部分；否则，它是一个空字符串。）</p>
<p>%…r: 请求的第一行 </p>
<p>%…s: 状态。对于进行内部重定向的请求，这是指*原来*请求 </p>
<p>的状态。如果用%…&gt;;s，则是指后来的请求。 </p>
<p>%…t: 以公共日志时间格式表示的时间（或称为标准英文格式） </p>
<p>%t: 以指定格式format表示的时间 </p>
<p>%…T: 为响应请求而耗费的时间，以秒计 </p>
<p>%…u: 远程用户（来自auth；如果返回状态（%s）是401则可能是伪造的） </p>
<p>%…U: 用户所请求的URL路径 </p>
<p>%…v: 响应请求的服务器的ServerName</p>
<p>%…V: 依照UseCanonicalName设置得到的服务器名字 </p>
<p>——————————————————————</p>
<p>　　 在所有上面列出的变量中，“…”表示一个可选的条件。如果没有指定条件，则变量的值将以“-”取代。分析前面来自默认httpd.conf文件的LogFormat指令示例，可以看出它创建了一种名为“common”的日志格式，其中包括：远程主机，远程登录名字，远程用户，请求时间，请求的第一行代码，请求状态，以及发送的字节数。</p>
<p>　　 有时候我们只想在日志中记录某些特定的、已定义的信息，这时就要用到“…”。如果在“%”和变量之间放入了一个或者多个HTTP状态代码，则只有当请求返回的状态代码属于指定的状态代码之一时，变量所代表的内容才会被记录。例如，如果我们想要记录的是网站的所有无效链接，那么可以使用：</p>
<p>—————————————————-</p>
<p>LogFormat @4{Referer}i BrokenLinks</p>
<p>—————————————————</p>
<p>　　 反之，如果我们想要记录那些状态代码不等于指定值的请求，只需加入一个“!”符号即可： </p>
<p>LogFormat %!200U SomethingWrong</p>
<p>Apche日志系列(4)：日志分析</p>
<p>尽管日志文件中包含着大量有用的信息，但这些信息只有在经过深入挖掘之后才能够最大限度地发挥作用。本文首先讨论了能够从日志文件获得的信息以及不能从日志文件获得的信息，然后介绍了几种优秀的日志分析工具以及如何自己编程分析日志文件。</p>
<p>一、可以得到哪些信息(4月4日)</p>
<p>　　 在这个《Apache日志》系列文章的前面几篇中，我们讨论了Apache的标准日志文件——访问日志和错误日志，以及如何定制日志文件。本文接下来讨论如何分析日志文件获得宝贵的统计信息。</p>
<p>　　 我们面临的问题是，虽然日志文件中包含了大量的信息，但这些信息对于我们管理、规划网站却没有多少直接的帮助。为了管理和规划网站，我们需要知道：有多少人浏览了网站，他们在看些什么，停留了多长时间，他们从哪里得知这个网站，等等。所有这些信息就隐藏于（或者可能隐藏于）日志文件之中。</p>
<p>　　 就网站的经营者而言，他们还希望知道浏览者的姓名、地址、鞋子大小，甚至还有浏览者的信用卡号码，但这些信息都不可能从日志文件中得到。为此，作为技术人员的我们就必须知道如何向这些经营者解释清楚：这部分信息不仅不可能从日志文件获得，而且要获得这些信息的唯一方法是直接向浏览者本人询问，并作好被拒绝的准备。</p>
<p>　　 有许多信息可以用日志文件来记录，其中包括： </p>
<p>远程机器的地址：“远程机器的地址”和“谁在浏览网站”差不多，但并不等同。具体地说，远程机器的地址告诉我们浏览者来自何方，比如它可能是buglet.rcbowen.com或者proxy01.aol.com。 </p>
<p>浏览时间：浏览者何时开始访问网站？从这个问题的答案中我们能够了解不少情况。如果网站的大多数浏览者都在早上9:00和下午4:00之间访问网站，那么可以相信网站的浏览者大多数总在工作时间进行访问；如果访问记录大多出现在下午7:00到午夜之间，我们可以肯定浏览者一般在家里上网。 当然，从单个访问记录能够得到的信息非常有限，但如果从数千个访问记录出发，我们就可以得到非常有用和重要的统计信息。</p>
<p>用户所访问的资源：网站的哪些部分最受用户欢迎？这些最受欢迎的部分就是我们应该继续加以发展的部分。网站的哪些部分总是受到冷落？网站中这些受到冷落的部分或许隐藏得太深，或许它们确实没有什么意思，此时我们就得想办法加以改进。当然，网站还有的内容，比如法律上的声明，虽然很少有人访问，但却不应该随便地改动它们。</p>
<p>无效链接：当然，日志文件还能够告诉我们哪些东西不能按照我们所想象地运行。网站中是否存在错误的链接？其他网站链接过来时有没有搞错URL？是否存在不能正常运行的CGI程序？是否有搜索引擎检索程序每秒发出数千个请求，从而影响了本网站的正常服务？这些问题的答案都可以从日志文件找到线索<br>
1,查看apache进程:<br>
ps aux | grep httpd | grep -v grep | wc -l<br>
2,查看80端口的tcp连接:<br>
netstat -tan | grep “ESTABLISHED” | grep “:80” | wc -l<br>
3,通过日志查看当天ip连接数，过滤重复:<br>
cat access_log | grep “20/Oct/2008” | awk ‘{print $1}’ | sort | uniq -c | sort -rn<br>
4,当天ip连接数最高的ip都在干些什么(原来是蜘蛛):<br>
cat access_log | grep “20/Oct/2008:00” | grep “122.102.7.212” | awk ‘{print $7}’ | sort | uniq -c | sort -rn | head -n 10<br>
5,当天访问页面排前10的url:<br>
cat access_log | awk ‘{if($8 ~ /HTTP\/1.1/)print $7}’ | sort | uniq -c | sort -nr | head -n 10<br>
6,用tcpdump嗅探80端口的访问看看谁最高<br>
tcpdump -i eth0 -t dst port 80 -c 1000 | awk -F”.” ‘{print $1″.”$2″.”$3″.”$4}’ | sort | uniq -c | sort –rn<br>
7,查看某一时间段的ip连接数:<br>
grep “2006:0[7-8]” access_log | awk ‘{print $2}’ | sort | uniq -c| sort -nr | wc -l</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1876 post type-post status-publish format-standard hentry category-115" id="post-1876">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1876">apache日志分析</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1876">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>1.什么是UV?<br>
UV是unique visitor的简写，是指独立访客，是以实际访问的电脑计数。<br>
2.什么是IP?<br>
IP是国际互联网协议(Internet Protocol)的简称，是通过网络间信息地址定位具体计算机的方式之一。<br>
3.UV和IP的概念有什么区别?<br>
对于IP来说，它在同一级别的网络(例如某个局域网、社区网、教学楼网或者INTERNET)范围内是唯一的，同一局域网内的所有电脑都只有一个共同ip。<br>
举例来说，我在一个局域网里，对外的IP是219.129.170.111，那么跟我同一局域网里的所有电脑都是这个IP，也就是说假如整个局域网的电脑都访问您的网站的话，在24小时内也只计算一个IP，所以相对UV来说不是很精确。<br>
而UV跟IP稍有不同，UV是访问你的网站的每一台电脑客户端。现在很多朋友用的网络都是局域网，引入了UV后，就能更精确的统计。<br>
总结：<br>
UV的统计数比IP更为准确，能够准确的计数每一台访问电脑，而IP把同一局域内的所有电脑视为一个。<br>
(PS:UV计数会涉及COOKIE。)<br>
上次因工作的需求对一台apache的log做了一次整体的分析,所以顺便也对apache的日志分析做下简单的介绍,主要参考apache官网的Log Files,手册参照 http://httpd.apache.org/docs/2.2/logs.html<br>
一.日志分析<br>
如果apache的安装时采用默认的配置,那么在/logs目录下就会生成两个文件,分别是access_log和error_log<br>
1.access_log<br>
access_log为访问日志,记录所有对apache服务器进行请求的访问,它的位置和内容由CustomLog指令控制,LogFormat指令可以用来简化该日志的内容和格式<br>
例如,我的其中一台服务器配置如下<br>
CustomLog “| /usr/sbin/rotatelogs /var/log/apache2/%Y_%m_%d_other_vhosts_access.log 86400 480″ vhost_combined<br>
-rw-r–r– 1 root root 22310750 12-05 23:59 2010_12_05_other_vhosts_access.log<br>
-rw-r–r– 1 root root 26873180 12-06 23:59 2010_12_06_other_vhosts_access.log<br>
-rw-r–r– 1 root root 26810003 12-07 23:59 2010_12_07_other_vhosts_access.log<br>
-rw-r–r– 1 root root 24530219 12-08 23:59 2010_12_08_other_vhosts_access.log<br>
-rw-r–r– 1 root root 24536681 12-09 23:59 2010_12_09_other_vhosts_access.log<br>
-rw-r–r– 1 root root 14003409 12-10 14:57 2010_12_10_other_vhosts_access.log<br>
通过CustomLog指令,每天一天生成一个独立的日志文件,同时也写了定时器将一周前的日志文件全部清除,这样可以显得更清晰,既可以分离每一天的日志又可以清除一定时间以前的日志通过制,LogFormat定义日志的记录格式<br>
LogFormat “%h %l %u %t \”%r\” %&gt;s %b \”%{Referer}i\” \”%{User-Agent}i\”” combined<br>
LogFormat “%{X-Forwarded-For}i %l %u %t \”%r\” %&gt;s %b \”%{Referer}i\” \”%{User-Agent}i\”” combinedproxy<br>
LogFormat “%h %l %u %t \”%r\” %&gt;s %b” common<br>
LogFormat “%{Referer}i -&gt; %U” referer<br>
LogFormat “%{User-agent}i” agent<br>
随意的tail一个access_log文件,下面是一条经典的访问记录<br>
218.19.140.242 – – [10/Dec/2010:09:31:17 +0800] “GET /query/trendxml/district/todayreturn/month/2009-12-14/2010-12-09/haizhu_tianhe.xml HTTP/1.1″ 200 1933 “-” “Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 (.NET CLR 3.5.30729)”<br>
一共是有9项,将他们一一拆开<br>
218.19.140.242<br>
–<br>
–<br>
[10/Dec/2010:09:31:17 +0800]<br>
“GET /query/trendxml/district/todayreturn/month/2009-12-14/2010-12-09/haizhu_tianhe.xml HTTP/1.1″<br>
200<br>
1933<br>
“-”<br>
“Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 (.NET CLR 3.5.30729)”<br>
1) 218.19.140.242 这是一个请求到apache服务器的客户端ip,默认的情况下,第一项信息只是远程主机的ip地址,但我们如果需要apache查出主机的名字,可以将 HostnameLookups设置为on,但这种做法是不推荐使用,因为它大大的减缓了服务器.另外这里的ip地址不一定就是客户主机的ip地址,如果 客户端使用了代理服务器,那么这里的ip就是代理服务器的地址,而不是原机.<br>
2) – 这一项是空白,使用”-”来代替,这个位置是用于标注访问者的标示,这个信息是由identd的客户端存在,除非IdentityCheck为on,非则apache是不会去获取该部分的信息(ps:不太理解,基本上这一项都是为空,奉上原文)<br>
The “hyphen” in the output indicates that the requested piece of information is not available. In this case, the information that is not available is the RFC 1413 identity of the client determined by identd on the clients machine. This information is highly unreliable and should almost never be used except on tightly controlled internal networks. Apache httpd will not even attempt to determine this information unless IdentityCheck is set to On.<br>
3) – 这一项又是为空白,不过这项是用户记录用户HTTP的身份验证,如果某些网站要求用户进行身份雁阵,那么这一项就是记录用户的身份信息<br>
4) [10/Dec/2010:09:31:17 +0800] 第四项是记录请求的时间,格式为[day/month/year:hour:minute:second zone],最后的+0800表示服务器所处的时区为东八区<br>
5) “GET /..haizhu_tianhe.xml HTTP/1.1″ 这一项整个记录中最有用的信息,首先,它告诉我们的服务器收到的是一个GET请求,其次,是客户端请求的资源路径,第三,客户端使用的协议时HTTP/1.1,整个格式为”%m %U%q %H”,即”请求方法/访问路径/协议”<br>
6) 200 这是一个状态码,由服务器端发送回客户端,它告诉我们客户端的请求是否成功,或者是重定向,或者是碰到了什么样的错误,这项值为200，表示服务器已经成 功的响应了客户端的请求,一般来说,这项值以2开头的表示请求成功,以3开头的表示重定向,以4开头的标示客户端存在某些的错误,以5开头的标示服务器端 存在某些错误,详细的可以参见 HTTP specification (RFC2616 section 10).[http://www.w3.org/Protocols/rfc2616/rfc2616.txt]<br>
7) 1933 这项表示服务器向客户端发送了多少的字节,在日志分析统计的时侯,把这些字节加起来就可以得知服务器在某点时间内总的发送数据量是多少<br>
8) – 暂不知<br>
9) “Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8 (.NET CLR 3.5.30729)” 这项主要记录客户端的浏览器信息<br>
2.error_log<br>
error_log为错误日志,记录下任何错误的处理请求,它的位置和内容由ErrorLog指令控制,通常服务器出现什么错误,首先对它进行查阅,是一个最重要的日志文件<br>
tail error_log,随意摘取一个记录<br>
[Fri Dec 10 15:03:59 2010] [error] [client 218.19.140.242] File does not exist: /home/htmlfile/tradedata/favicon.ico<br>
同样也是分为几个项<br>
[Fri Dec 10 15:03:59 2010]<br>
[error]<br>
[client 218.19.140.242]<br>
File does not exist: /home/htmlfile/tradedata/favicon.ico<br>
1) [Fri Dec 10 15:03:59 2010] 记录错误发生的时间,注意,它跟我们上面access_log记录的时间格式是不同的<br>
2) [error] 这一项为错误的级别,根据LogLevel指令来控制错误的类别,上面的404是属于error级别<br>
3) [client 218.19.140.242] 记录客户端的ip地址<br>
4) File does not exist: /home/htmlfile/tradedata/favicon.ico 这一项首先对错误进行了描述,例如客户端访问一个不存在或路径错误的文件,就会给出404的提示错误<br>
二.实用的日志分析脚本<br>
了解日志的各种定义后,这里分享一下从网上淘来的一些对日志分析的脚本<br>
1.查看apache的进程数<br>
ps -aux | grep httpd | wc -l<br>
2.分析日志查看当天的ip连接数<br>
cat default-access_log | grep “10/Dec/2010″ | awk ‘{print $2}’ | sort | uniq -c | sort -nr<br>
3.查看指定的ip在当天究竟访问了什么url<br>
cat default-access_log | grep “10/Dec/2010″ | grep “218.19.140.242″ | awk ‘{print $7}’ | sort | uniq -c | sort -nr<br>
4.查看当天访问排行前10的url<br>
cat default-access_log | grep “10/Dec/2010″ | awk ‘{print $7}’ | sort | uniq -c | sort -nr | head -n 10<br>
5.看到指定的ip究竟干了什么<br>
cat default-access_log | grep 218.19.140.242 | awk ‘{print $1″\t”$8}’ | sort | uniq -c | sort -nr | less<br>
6.查看访问次数最多的几个分钟(找到热点)<br>
awk ‘{print $4}’ default-access_log |cut -c 14-18|sort|uniq -c|sort -nr|head<br>
三.使用awstats自动分析日志<br>
当然啦,如果想最简单和最直观的分析日志还是用工具,现在网上较流行的工具是awstats,一个基于perl的web日志分析工具,功能很强大也支持IIS等服务器</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1874 post type-post status-publish format-standard hentry category-115" id="post-1874">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1874">Apache如何每天生成独立日志文件(access_log和error_log)</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1874">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>apache运行自动生成access_log（访问日志）和error_log（错误日志）两种日志文件，这对于系统管理员或网站运营人员是非常有用的。<br>
我安装的是centos，使用yum方式安装lamp环境的，日志文件位置：<br>
/var/log/httpd/access_log是Apache服务器的访问日志文件<br>
/var/log/httpd/error_log是Apache服务器的错误日志文件<br>
如果把所有的访问日志都放在access_log,所有的错误日志都放在error_log文件，那么着两个文件肯定会很大，你打开日志的时间都会很长，别说看了，而且影响网站速度。我看了下php点点通，刚转到阿里云才几天，日志文件都有几十兆了，因此限制日志文件大小是很有必要的。<br>
打开apache的配置文件：vi /etc/httpd/conf/httpd.conf<br>
编辑：<br>
#错误日志<br>
#ErrorLog logs/error_log #注释，加上下面这行<br>
ErrorLog “|rotatelogs /var/log/httpd/error_log%Y_%m_%d.log 86400 480”  #每天生成错误日志<br>
#访问日志<br>
#CustomLog logs/access_log common #注释加上下面这样<br>
CustomLog “|rotatelogs /var/log/httpd/access_log%Y_%m_%d.log 86400 480″ common #每天生成访问日志<br>
OK，重启apache,你就可以看到新生成的日志文件：<br>
Apache如何每天生成独立日志文件(access_log和error_log)<br>
Rotatelogs的用法如下：</p>
<p>rotatelogs [ -l ] logfile [ rotationtime [ offset ]] | [ filesizeM ]<br>
选项：<br>
    -l<br>
    使用本地时间代替GMT时间作为时间基准。注意：在一个改变GMT偏移量(比如夏令时)的环境中使用-l会导致不可预料的结果。<br>
    logfile<br>
    它加上基准名就是日志文件名。如果logfile中包含”%”，则它会被视为用于strftime()的格式字符串；否则它会被自动加上以秒为单位的”.nnnnnnnnnn”后缀。这两种格式都表示新的日志开始使用的时间。<br>
    rotationtime<br>
    日志文件滚动的以秒为单位的间隔时间。<br>
    offset<br>
    相对于UTC的时差的分钟数。如果省略，则假定为”0″并使用UTC时间。比如，要指定UTC时差为”-5小时”的地区的当地时间，则此参数应为”-300″。<br>
    filesizeM<br>
    指定以filesizeM文件大小滚动，而不是按照时间或时差滚动。<br>
转载请注明地址: http://www.phpddt.com/server/apache-access-error-log.html 尊重他人劳动成果就是尊重自己!</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1872 post type-post status-publish format-standard hentry category-115" id="post-1872">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1872">如何分析apache日志[access_log（访问日志）和error_log（错误日志）]</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1872">2015年7月7日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>默认Apache运行会access_log（访问日志）和error_log（错误日志）两个日志文件。<br>
看一条典型的access_log的日志记录：<br>
61.155.149.20 – – [17/Dec/2013:05:42:47 +0800] “GET /category/db/ HTTP/1.1″ 200 23225<br>
1)61.155.149.20 这是一个请求到apache服务器的客户端ip,默认的情况下,第一项信息只是远程主机的ip地址,但我们如果需要apache查出主机的名字,可以将 HostnameLookups设置为on,不推荐使用，会大大降低网站速度。</p>
<p>2) – 这一项是空白,使用”-“来代替,用于记录浏览者的标识，对于大多数浏览器，这项都是空。</p>
<p>3) – 也为空，记录浏览者进行身份验证时提供的名字，大多数这项也为空。</p>
<p>4) [17/Dec/2013:05:42:47 +0800]第四项是记录请求的时间,格式为[day/month/year:hour:minute:second zone],最后的+0800表示服务器所处的时区为东八区</p>
<p>5) “GET /category/db/ HTTP/1.1″ 这一项最有用,首先,它告诉我们的服务器收到的是一个GET请求,其次,是客户端请求的资源路径,第三,客户端使用的协议时HTTP/1.1,整个格式为”%m %U%q %H”,即”请求方法/访问路径/协议”</p>
<p>6) 200 这是一个状态码,由服务器端发送回客户端,它告诉我们客户端的请求是否成功,或者是重定向,或者是碰到了什么样的错误,这项值为200，表示服务器已经成 功的响应了客户端的请求,一般来说,这项值以2开头的表示请求成功,以3开头的表示重定向,以4开头的标示客户端存在某些的错误,以5开头的标示服务器端 存在某些错误。</p>
<p>7) 23225 这项表示服务器向客户端发送了多少的字节,在日志分析统计的时侯,把这些字节加起来就可以得知服务器在某点时间内总的发送数据量是多少</p>
<p>再来看一条error_log信息：<br>
[Tue Dec 17 02:22:46 2013] [error] [client 61.182.137.33] File does not exist: /var/www/html/usr/themes/dddefault/all.txt<br>
1) [Tue Dec 17 02:22:46 2013] 记录错误发生的时间,注意,它跟我们上面access_log记录的时间格式是不同的<br>
2) [error] 这一项为错误的级别,根据LogLevel指令来控制错误的类别,上面的404是属于error级别<br>
3) [client 61.182.137.33] 记录客户端的ip地址<br>
4) File does not exist: /var/www/html/usr/themes/dddefault/all.txt 错误描述。</p>
<p>转载请注明地址: http://www.phpddt.com/server/apache-log.html 尊重他人劳动成果就是尊重自己!</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1866 post type-post status-publish format-standard hentry category-vip tag-mac tag-xampp" id="post-1866">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/vip" rel="category tag">vip</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1866">Mac OS X 10.10 Yosemite下面解决XAMPP无法开启mysql的问题</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1866">2015年7月4日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>在xampp安装目录下找到xamp这个文件（默认路径是：/Applications/XAMPP/xamppfiles/xampp）<br>
用文本编辑器打开，搜索：$XAMPP_ROOT/bin/mysql.server start &gt; /dev/null &amp;<br>
在那一行前面添加：  unset DYLD_LIBRARY_PATH<br>
保存退出，重新打开xampp，开启MySQL。<br>
卧槽，居然变绿了，成功了</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
		<div class="post-meta-wrapper post-meta-single post-meta-single-bottom">

			<ul class="post-meta">

									<li class="post-tags meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								标签							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 18 18"><path fill="" d="M15.4496399,8.42490555 L8.66109799,1.63636364 L1.63636364,1.63636364 L1.63636364,8.66081885 L8.42522727,15.44178 C8.57869221,15.5954158 8.78693789,15.6817418 9.00409091,15.6817418 C9.22124393,15.6817418 9.42948961,15.5954158 9.58327627,15.4414581 L15.4486339,9.57610048 C15.7651495,9.25692435 15.7649133,8.74206554 15.4496399,8.42490555 Z M16.6084423,10.7304545 L10.7406818,16.59822 C10.280287,17.0591273 9.65554997,17.3181054 9.00409091,17.3181054 C8.35263185,17.3181054 7.72789481,17.0591273 7.26815877,16.5988788 L0.239976954,9.57887876 C0.0863319284,9.4254126 0,9.21716044 0,9 L0,0.818181818 C0,0.366312477 0.366312477,0 0.818181818,0 L9,0 C9.21699531,0 9.42510306,0.0862010512 9.57854191,0.239639906 L16.6084423,7.26954545 C17.5601275,8.22691012 17.5601275,9.77308988 16.6084423,10.7304545 Z M5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 C5.55228475,4 6,4.44771525 6,5 C6,5.55228475 5.55228475,6 5,6 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/tag/mac" rel="tag">mac</a>, <a href="/archives/tag/xampp" rel="tag">xampp</a>						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1863 post type-post status-publish format-standard hentry category-115" id="post-1863">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1863">账号和帐号的区别</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1863">2015年6月24日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>账号：和钱相关的身份标示<br>
帐号：权限相关的身份标示</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
	</div><!-- .section-inner -->

	
</article><!-- .post -->
<hr class="post-separator styled-separator is-style-wide section-inner" aria-hidden="true">
<article class="post-1861 post type-post status-publish format-standard hentry category-115 tag-122" id="post-1861">

	
<header class="entry-header has-text-align-center">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">
					分类				</span>
				<div class="entry-categories-inner">
					<a href="/archives/category/%e4%ba%92%e8%81%94%e7%bd%91%e8%90%a5%e9%94%80" rel="category tag">互联网营销</a>				</div><!-- .entry-categories-inner -->
			</div><!-- .entry-categories -->

			<h2 class="entry-title heading-size-1"><a href="/archives/1861">由身份证可以提取地域，年龄和性别</a></h2>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								文章作者							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/author/amyflash">amyflash</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								发布日期							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/1861">2015年6月24日</a>
						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .entry-header-inner -->

</header><!-- .entry-header -->

	<div class="post-inner thin ">

		<div class="entry-content">

			<p>18位身份证号码各位的含义: 1-2位省、自治区、直辖市代码； 3-4位地级市、盟、自治州代码； 5-6位县、县级市、区代码； 7-14位出生年月日，比如19670401代表1967年4月1日； 15-17位为顺序号，其中17位（倒数第二位）男为单数，女为双数； 18位为校验码，0-9和X。作为尾号的校验码，是由把前十七位数字带入统一的公式计算出来的，计算的结果是0-10，如果某人的尾号是0－9，都不会出现X，但如果尾号是10，那么就得用X来代替，因为如果用10做尾号，那么此人的身份证就变成了19位。X是罗马数字的10，用X来代替10。 举例： 130503 19670401 0012这个身份证号的含义: 13为河北，05为邢台，03为桥西区，出生日期为1967年4月1日，顺序号为001，2为校验码。</p>

		</div><!-- .entry-content -->

	</div><!-- .post-inner -->

	<div class="section-inner">
		
		<div class="post-meta-wrapper post-meta-single post-meta-single-bottom">

			<ul class="post-meta">

									<li class="post-tags meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">
								标签							</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 18 18"><path fill="" d="M15.4496399,8.42490555 L8.66109799,1.63636364 L1.63636364,1.63636364 L1.63636364,8.66081885 L8.42522727,15.44178 C8.57869221,15.5954158 8.78693789,15.6817418 9.00409091,15.6817418 C9.22124393,15.6817418 9.42948961,15.5954158 9.58327627,15.4414581 L15.4486339,9.57610048 C15.7651495,9.25692435 15.7649133,8.74206554 15.4496399,8.42490555 Z M16.6084423,10.7304545 L10.7406818,16.59822 C10.280287,17.0591273 9.65554997,17.3181054 9.00409091,17.3181054 C8.35263185,17.3181054 7.72789481,17.0591273 7.26815877,16.5988788 L0.239976954,9.57887876 C0.0863319284,9.4254126 0,9.21716044 0,9 L0,0.818181818 C0,0.366312477 0.366312477,0 0.818181818,0 L9,0 C9.21699531,0 9.42510306,0.0862010512 9.57854191,0.239639906 L16.6084423,7.26954545 C17.5601275,8.22691012 17.5601275,9.77308988 16.6084423,10.7304545 Z M5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 C5.55228475,4 6,4.44771525 6,5 C6,5.55228475 5.55228475,6 5,6 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="/archives/tag/%e8%ba%ab%e4%bb%bd%e8%af%81" rel="tag">身份证</a>						</span>
					</li>
					
			</ul><!-- .post-meta -->

		</div><!-- .post-meta-wrapper -->

		
	</div><!-- .section-inner -->

	
</article><!-- .post -->

	
	<div class="pagination-wrapper section-inner">

		<hr class="styled-separator pagination-separator is-style-wide" aria-hidden="true">

		
	<nav class="navigation pagination" aria-label="文章分页">
		<h2 class="screen-reader-text">文章分页</h2>
		<div class="nav-links"><a class="prev page-numbers" href="/archives/author/amyflash/page/54"><span aria-hidden="true">←</span> <span class="nav-prev-text">较新<span class="nav-short">文章</span></span></a>
<a class="page-numbers" href="/archives/author/amyflash/">1</a>
<span class="page-numbers dots">…</span>
<a class="page-numbers" href="/archives/author/amyflash/page/54">54</a>
<span aria-current="page" class="page-numbers current">55</span>
<a class="page-numbers" href="/archives/author/amyflash/page/56">56</a>
<span class="page-numbers dots">…</span>
<a class="page-numbers" href="/archives/author/amyflash/page/100">100</a>
<a class="next page-numbers" href="/archives/author/amyflash/page/56"><span class="nav-next-text">较早<span class="nav-short">文章</span></span> <span aria-hidden="true">→</span></a></div>
	</nav>
	</div><!-- .pagination-wrapper -->

	
</main><!-- #site-content -->


	<div class="footer-nav-widgets-wrapper header-footer-group">

		<div class="footer-inner section-inner">

			
			
				<aside class="footer-widgets-outer-wrapper">

					<div class="footer-widgets-wrapper">

						
							<div class="footer-widgets column-one grid-item">
								<div class="widget_text widget widget_custom_html"><div class="widget_text widget-content"><h2 class="widget-title subheading heading-size-3">常用链接</h2><div class="textwidget custom-html-widget"><a href="https://www.perplexity.ai/">ai搜索</a><br>
<a href="https://huggingface.co/models">模型下载</a>
<a href="https://kb.amyflash.com/">接口工具</a>
</div></div></div><div class="widget widget_tag_cloud"><div class="widget-content"><h2 class="widget-title subheading heading-size-3">标签</h2><nav aria-label="标签"><div class="tagcloud"><a href="/archives/tag/air" class="tag-cloud-link tag-link-45 tag-link-position-1" style="font-size: 8pt;" aria-label="air (2 项)">air</a>
<a href="/archives/tag/angularjs" class="tag-cloud-link tag-link-212 tag-link-position-2" style="font-size: 15.736842105263pt;" aria-label="angularjs (12 项)">angularjs</a>
<a href="/archives/tag/apache" class="tag-cloud-link tag-link-123 tag-link-position-3" style="font-size: 8pt;" aria-label="apache (2 项)">apache</a>
<a href="/archives/tag/as3" class="tag-cloud-link tag-link-6 tag-link-position-4" style="font-size: 16.228070175439pt;" aria-label="as3 (13 项)">as3</a>
<a href="/archives/tag/chrome" class="tag-cloud-link tag-link-90 tag-link-position-5" style="font-size: 8pt;" aria-label="chrome (2 项)">chrome</a>
<a href="/archives/tag/createjs" class="tag-cloud-link tag-link-31 tag-link-position-6" style="font-size: 8pt;" aria-label="createjs (2 项)">createjs</a>
<a href="/archives/tag/css3" class="tag-cloud-link tag-link-228 tag-link-position-7" style="font-size: 9.4736842105263pt;" aria-label="css3 (3 项)">css3</a>
<a href="/archives/tag/date" class="tag-cloud-link tag-link-7 tag-link-position-8" style="font-size: 8pt;" aria-label="date (2 项)">date</a>
<a href="/archives/tag/django" class="tag-cloud-link tag-link-197 tag-link-position-9" style="font-size: 9.4736842105263pt;" aria-label="django (3 项)">django</a>
<a href="/archives/tag/docker" class="tag-cloud-link tag-link-239 tag-link-position-10" style="font-size: 12.543859649123pt;" aria-label="docker (6 项)">docker</a>
<a href="/archives/tag/eos" class="tag-cloud-link tag-link-214 tag-link-position-11" style="font-size: 11.684210526316pt;" aria-label="eos (5 项)">eos</a>
<a href="/archives/tag/eth" class="tag-cloud-link tag-link-198 tag-link-position-12" style="font-size: 9.4736842105263pt;" aria-label="ETH (3 项)">ETH</a>
<a href="/archives/tag/flash" class="tag-cloud-link tag-link-12 tag-link-position-13" style="font-size: 12.543859649123pt;" aria-label="flash (6 项)">flash</a>
<a href="/archives/tag/flashdevelop" class="tag-cloud-link tag-link-28 tag-link-position-14" style="font-size: 8pt;" aria-label="flashdevelop (2 项)">flashdevelop</a>
<a href="/archives/tag/flv" class="tag-cloud-link tag-link-63 tag-link-position-15" style="font-size: 8pt;" aria-label="flv (2 项)">flv</a>
<a href="/archives/tag/git" class="tag-cloud-link tag-link-152 tag-link-position-16" style="font-size: 12.543859649123pt;" aria-label="git (6 项)">git</a>
<a href="/archives/tag/google" class="tag-cloud-link tag-link-116 tag-link-position-17" style="font-size: 9.4736842105263pt;" aria-label="google (3 项)">google</a>
<a href="/archives/tag/haxe" class="tag-cloud-link tag-link-118 tag-link-position-18" style="font-size: 8pt;" aria-label="haxe (2 项)">haxe</a>
<a href="/archives/tag/html5" class="tag-cloud-link tag-link-5 tag-link-position-19" style="font-size: 10.701754385965pt;" aria-label="html5 (4 项)">html5</a>
<a href="/archives/tag/iphone" class="tag-cloud-link tag-link-51 tag-link-position-20" style="font-size: 8pt;" aria-label="iphone (2 项)">iphone</a>
<a href="/archives/tag/jangaroo" class="tag-cloud-link tag-link-67 tag-link-position-21" style="font-size: 10.701754385965pt;" aria-label="Jangaroo (4 项)">Jangaroo</a>
<a href="/archives/tag/java" class="tag-cloud-link tag-link-3 tag-link-position-22" style="font-size: 9.4736842105263pt;" aria-label="java (3 项)">java</a>
<a href="/archives/tag/javascript" class="tag-cloud-link tag-link-68 tag-link-position-23" style="font-size: 8pt;" aria-label="javascript (2 项)">javascript</a>
<a href="/archives/tag/js" class="tag-cloud-link tag-link-36 tag-link-position-24" style="font-size: 11.684210526316pt;" aria-label="js (5 项)">js</a>
<a href="/archives/tag/jsp" class="tag-cloud-link tag-link-107 tag-link-position-25" style="font-size: 8pt;" aria-label="jsp (2 项)">jsp</a>
<a href="/archives/tag/lampp" class="tag-cloud-link tag-link-93 tag-link-position-26" style="font-size: 10.701754385965pt;" aria-label="lampp (4 项)">lampp</a>
<a href="/archives/tag/laravel" class="tag-cloud-link tag-link-194 tag-link-position-27" style="font-size: 9.4736842105263pt;" aria-label="laravel (3 项)">laravel</a>
<a href="/archives/tag/linux" class="tag-cloud-link tag-link-32 tag-link-position-28" style="font-size: 15.368421052632pt;" aria-label="linux (11 项)">linux</a>
<a href="/archives/tag/mac" class="tag-cloud-link tag-link-8 tag-link-position-29" style="font-size: 13.771929824561pt;" aria-label="mac (8 项)">mac</a>
<a href="/archives/tag/mysql" class="tag-cloud-link tag-link-34 tag-link-position-30" style="font-size: 18.561403508772pt;" aria-label="mysql (21 项)">mysql</a>
<a href="/archives/tag/php" class="tag-cloud-link tag-link-44 tag-link-position-31" style="font-size: 16.59649122807pt;" aria-label="php (14 项)">php</a>
<a href="/archives/tag/python" class="tag-cloud-link tag-link-202 tag-link-position-32" style="font-size: 16.228070175439pt;" aria-label="python (13 项)">python</a>
<a href="/archives/tag/securecrt" class="tag-cloud-link tag-link-99 tag-link-position-33" style="font-size: 9.4736842105263pt;" aria-label="securecrt (3 项)">securecrt</a>
<a href="/archives/tag/shell" class="tag-cloud-link tag-link-33 tag-link-position-34" style="font-size: 13.157894736842pt;" aria-label="shell (7 项)">shell</a>
<a href="/archives/tag/swf" class="tag-cloud-link tag-link-13 tag-link-position-35" style="font-size: 9.4736842105263pt;" aria-label="swf (3 项)">swf</a>
<a href="/archives/tag/ubuntu" class="tag-cloud-link tag-link-136 tag-link-position-36" style="font-size: 10.701754385965pt;" aria-label="ubuntu (4 项)">ubuntu</a>
<a href="/archives/tag/vps" class="tag-cloud-link tag-link-91 tag-link-position-37" style="font-size: 8pt;" aria-label="vps (2 项)">vps</a>
<a href="/archives/tag/vue" class="tag-cloud-link tag-link-213 tag-link-position-38" style="font-size: 15.368421052632pt;" aria-label="vue (11 项)">vue</a>
<a href="/archives/tag/wordpress" class="tag-cloud-link tag-link-10 tag-link-position-39" style="font-size: 8pt;" aria-label="wordpress (2 项)">wordpress</a>
<a href="/archives/tag/xampp" class="tag-cloud-link tag-link-94 tag-link-position-40" style="font-size: 16.228070175439pt;" aria-label="xampp (13 项)">xampp</a>
<a href="/archives/tag/yii2" class="tag-cloud-link tag-link-128 tag-link-position-41" style="font-size: 22pt;" aria-label="yii2 (41 项)">yii2</a>
<a href="/archives/tag/%e4%ba%a7%e5%93%81" class="tag-cloud-link tag-link-64 tag-link-position-42" style="font-size: 8pt;" aria-label="产品 (2 项)">产品</a>
<a href="/archives/tag/%e6%bb%9a%e5%8a%a8%e6%9d%a1" class="tag-cloud-link tag-link-38 tag-link-position-43" style="font-size: 9.4736842105263pt;" aria-label="滚动条 (3 项)">滚动条</a>
<a href="/archives/tag/%e7%ab%af%e5%8f%a3" class="tag-cloud-link tag-link-117 tag-link-position-44" style="font-size: 8pt;" aria-label="端口 (2 项)">端口</a>
<a href="/archives/tag/%e7%b2%92%e5%ad%90" class="tag-cloud-link tag-link-21 tag-link-position-45" style="font-size: 8pt;" aria-label="粒子 (2 项)">粒子</a></div>
</nav></div></div><div class="widget widget_pages"><div class="widget-content"><h2 class="widget-title subheading heading-size-3">页面</h2><nav aria-label="页面">
			<ul>
				<li class="page_item page-item-2696"><a href="/angularjs2%e5%ad%a6%e4%b9%a0%e7%b3%bb%e5%88%97">angularjs4+学习系列</a></li>
<li class="page_item page-item-6460 current_page_parent"><a href="/arweare%e9%93%be%e4%b8%8a%e7%9a%84%e6%b0%b8%e4%b9%85%e7%bd%91%e7%ab%99">Arweare链上的永久网站</a></li>
<li class="page_item page-item-5680"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-10%e6%9c%88">The one year love-心灵之约-多多说系列专题-10月</a></li>
<li class="page_item page-item-5782"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-11%e6%9c%88">The one year love-心灵之约-多多说系列专题-11月</a></li>
<li class="page_item page-item-5878"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-12%e6%9c%88">The one year love-心灵之约-多多说系列专题-12月</a></li>
<li class="page_item page-item-6010"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-202401%e6%9c%88">The one year love-心灵之约-多多说系列专题-202401月</a></li>
<li class="page_item page-item-6140"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-202402%e6%9c%88">The one year love-心灵之约-多多说系列专题-202402月</a></li>
<li class="page_item page-item-6254"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-202403%e6%9c%88">The one year love-心灵之约-多多说系列专题-202403月</a></li>
<li class="page_item page-item-4797"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6">The one year love-心灵之约-多多说系列专题-4月</a></li>
<li class="page_item page-item-5116"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-5%e6%9c%88">The one year love-心灵之约-多多说系列专题-5月</a></li>
<li class="page_item page-item-5174"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-6%e6%9c%88">The one year love-心灵之约-多多说系列专题-6月</a></li>
<li class="page_item page-item-5298"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-7%e6%9c%88">The one year love-心灵之约-多多说系列专题-7月</a></li>
<li class="page_item page-item-5412"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-8%e6%9c%88">The one year love-心灵之约-多多说系列专题-8月</a></li>
<li class="page_item page-item-5592"><a href="/the-one-year-love-%e5%bf%83%e7%81%b5%e4%b9%8b%e7%ba%a6-%e5%a4%9a%e5%a4%9a%e8%af%b4%e7%b3%bb%e5%88%97%e4%b8%93%e9%a2%98-9%e6%9c%88">The one year love-心灵之约-多多说系列专题-9月</a></li>
<li class="page_item page-item-2870"><a href="/vue%e7%b3%bb%e5%88%97%e6%95%99%e7%a8%8b">vue学习系列</a></li>
<li class="page_item page-item-2770"><a href="/yii2%e5%ad%a6%e4%b9%a0%e7%b3%bb%e5%88%97">yii2学习系列</a></li>
<li class="page_item page-item-6345"><a href="/">养生音乐</a></li>
<li class="page_item page-item-6400"><a href="/shop">商店</a></li>
<li class="page_item page-item-6357"><a href="/%e5%a4%9a%e5%a4%9a%e8%af%b4%e4%b8%93%e9%a2%98">多多说专题</a></li>
<li class="page_item page-item-6403"><a href="/my-account">我的帐户</a></li>
<li class="page_item page-item-3720"><a href="/%e6%88%91%e7%9a%84%e8%87%aa%e5%aa%92%e4%bd%93">我的自媒体</a></li>
<li class="page_item page-item-2"><a href="/sample-page">留言版</a></li>
<li class="page_item page-item-6402"><a href="/checkout">结账</a></li>
<li class="page_item page-item-6401"><a href="/cart">购物车</a></li>
			</ul>

			</nav></div></div>							</div>

						
						
					</div><!-- .footer-widgets-wrapper -->

				</aside><!-- .footer-widgets-outer-wrapper -->

			
		</div><!-- .footer-inner -->

	</div><!-- .footer-nav-widgets-wrapper -->

	
			<footer id="site-footer" class="header-footer-group">

				<div class="section-inner">

					<div class="footer-credits">

						<p class="footer-copyright">©
							2025							<a href="/">逍遥居</a>
						</p><!-- .footer-copyright -->

						
						<p class="powered-by-wordpress">
							<a href="https://cn.wordpress.org/">
								由WordPress强力驱动							</a>
						</p><!-- .powered-by-wordpress -->

					</div><!-- .footer-credits -->

					<a class="to-the-top" href="#site-header">
						<span class="to-the-top-long">
							返回顶部<span class="arrow" aria-hidden="true">↑</span>						</span><!-- .to-the-top-long -->
						<span class="to-the-top-short">
							向上 <span class="arrow" aria-hidden="true">↑</span>						</span><!-- .to-the-top-short -->
					</a><!-- .to-the-top -->

				</div><!-- .section-inner -->

			</footer><!-- #site-footer -->

		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/twentytwenty\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>

	</body>
</html>
